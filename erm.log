Training a feature extractor using erm on <class 'datasets.domainbed.OfficeHome'> with domain Art held out.
Training a feature extractor.
Save dir: ./results/OfficeHome/omit_Art/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.OfficeHome'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['Clipart', 'Product', 'Real World'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 74.47438287734985 seconds
	Train rv:
		loss: 4.393189430236816
		acc: 0.022443181818181817
	Val rv:
		loss: 4.074968338012695
		acc: 0.04066265060240964
New best model found.
Epoch 2 complete in 74.17333674430847 seconds
	Train rv:
		loss: 4.036449909210205
		acc: 0.03598484848484849
	Val rv:
		loss: 3.939239978790283
		acc: 0.04969879518072289
New best model found.
Epoch 3 complete in 74.54999113082886 seconds
	Train rv:
		loss: 3.9140994548797607
		acc: 0.05350378787878788
	Val rv:
		loss: 3.8631742000579834
		acc: 0.0651355421686747
New best model found.
Epoch 4 complete in 74.39220547676086 seconds
	Train rv:
		loss: 3.7782700061798096
		acc: 0.08503787878787879
	Val rv:
		loss: 3.737750768661499
		acc: 0.10542168674698796
New best model found.
Epoch 5 complete in 74.67872667312622 seconds
	Train rv:
		loss: 3.625840425491333
		acc: 0.1215909090909091
	Val rv:
		loss: 3.588752031326294
		acc: 0.12161144578313253
New best model found.
Epoch 6 complete in 73.52196884155273 seconds
	Train rv:
		loss: 3.406421661376953
		acc: 0.1618371212121212
	Val rv:
		loss: 3.349992036819458
		acc: 0.19164156626506024
New best model found.
Epoch 7 complete in 73.40625214576721 seconds
	Train rv:
		loss: 3.184562921524048
		acc: 0.21070075757575757
	Val rv:
		loss: 3.123171091079712
		acc: 0.25376506024096385
New best model found.
Epoch 8 complete in 73.07049632072449 seconds
	Train rv:
		loss: 2.9347662925720215
		acc: 0.26392045454545454
	Val rv:
		loss: 3.1701815128326416
		acc: 0.21875
Epochs without improvement: 1
Epoch 9 complete in 74.22648429870605 seconds
	Train rv:
		loss: 2.7172560691833496
		acc: 0.30634469696969696
	Val rv:
		loss: 3.342317819595337
		acc: 0.21272590361445784
Epochs without improvement: 2
Epoch 10 complete in 73.32979154586792 seconds
	Train rv:
		loss: 2.5347037315368652
		acc: 0.3459280303030303
	Val rv:
		loss: 2.6585707664489746
		acc: 0.3460090361445783
New best model found.
Epoch 11 complete in 73.80718564987183 seconds
	Train rv:
		loss: 2.3106496334075928
		acc: 0.40331439393939394
	Val rv:
		loss: 2.6519718170166016
		acc: 0.3433734939759036
Epochs without improvement: 1
Epoch 12 complete in 74.09026646614075 seconds
	Train rv:
		loss: 2.0417447090148926
		acc: 0.45852272727272725
	Val rv:
		loss: 2.650698661804199
		acc: 0.37387048192771083
New best model found.
Epoch 13 complete in 73.7047951221466 seconds
	Train rv:
		loss: 1.8040003776550293
		acc: 0.5192234848484848
	Val rv:
		loss: 2.5830514430999756
		acc: 0.4118975903614458
New best model found.
Epoch 14 complete in 73.2997875213623 seconds
	Train rv:
		loss: 1.5372744798660278
		acc: 0.5824810606060606
	Val rv:
		loss: 2.6138150691986084
		acc: 0.40248493975903615
Epochs without improvement: 1
Epoch 15 complete in 72.55473184585571 seconds
	Train rv:
		loss: 1.3366771936416626
		acc: 0.6304924242424242
	Val rv:
		loss: 2.6060168743133545
		acc: 0.4292168674698795
New best model found.
Epoch 16 complete in 72.87087273597717 seconds
	Train rv:
		loss: 1.1051055192947388
		acc: 0.680965909090909
	Val rv:
		loss: 2.6567516326904297
		acc: 0.4303463855421687
New best model found.
Epoch 17 complete in 73.02470541000366 seconds
	Train rv:
		loss: 0.891897976398468
		acc: 0.7385416666666667
	Val rv:
		loss: 2.9471890926361084
		acc: 0.42771084337349397
Epochs without improvement: 1
Epoch 18 complete in 72.91893124580383 seconds
	Train rv:
		loss: 0.7909165024757385
		acc: 0.7650568181818181
	Val rv:
		loss: 2.9937217235565186
		acc: 0.4495481927710843
New best model found.
Epoch 19 complete in 72.7286217212677 seconds
	Train rv:
		loss: 0.5498969554901123
		acc: 0.8292613636363636
	Val rv:
		loss: 3.0728588104248047
		acc: 0.4634789156626506
New best model found.
Epoch 20 complete in 73.26361680030823 seconds
	Train rv:
		loss: 0.4495469927787781
		acc: 0.8613636363636363
	Val rv:
		loss: 3.7412538528442383
		acc: 0.42055722891566266
Epochs without improvement: 1
Epoch 21 complete in 72.97187876701355 seconds
	Train rv:
		loss: 0.5642167329788208
		acc: 0.8365530303030303
	Val rv:
		loss: 3.231102228164673
		acc: 0.44917168674698793
Epochs without improvement: 2
Epoch 22 complete in 72.61600613594055 seconds
	Train rv:
		loss: 0.29368916153907776
		acc: 0.9143939393939394
	Val rv:
		loss: 3.5828471183776855
		acc: 0.4559487951807229
Epochs without improvement: 3
Epoch 23 complete in 73.63258409500122 seconds
	Train rv:
		loss: 0.28515273332595825
		acc: 0.9144886363636363
	Val rv:
		loss: 3.6230170726776123
		acc: 0.4442771084337349
Epochs without improvement: 4
Epoch 24 complete in 73.38430166244507 seconds
	Train rv:
		loss: 0.2363985925912857
		acc: 0.9307765151515152
	Val rv:
		loss: 3.589331865310669
		acc: 0.4503012048192771
Epochs without improvement: 5
Epoch 25 complete in 73.03639721870422 seconds
	Train rv:
		loss: 0.2552957534790039
		acc: 0.9244318181818182
	Val rv:
		loss: 3.6518149375915527
		acc: 0.4246987951807229
Epochs without improvement: 6
Epoch 26 complete in 72.63157510757446 seconds
	Train rv:
		loss: 0.20365454256534576
		acc: 0.9423295454545455
	Val rv:
		loss: 3.826051712036133
		acc: 0.4627259036144578
Epochs without improvement: 7
Epoch 27 complete in 72.87161231040955 seconds
	Train rv:
		loss: 0.1893322616815567
		acc: 0.9452651515151516
	Val rv:
		loss: 3.737034797668457
		acc: 0.4664909638554217
New best model found.
Epoch 28 complete in 72.66890239715576 seconds
	Train rv:
		loss: 0.1729172021150589
		acc: 0.9514204545454545
	Val rv:
		loss: 3.922309637069702
		acc: 0.4567018072289157
Epochs without improvement: 1
Epoch 29 complete in 73.29042530059814 seconds
	Train rv:
		loss: 0.15534208714962006
		acc: 0.9575757575757575
	Val rv:
		loss: 4.986245632171631
		acc: 0.42018072289156627
Epochs without improvement: 2
Epoch 30 complete in 73.62023830413818 seconds
	Train rv:
		loss: 0.36842164397239685
		acc: 0.9050189393939394
	Val rv:
		loss: 3.7388463020324707
		acc: 0.4619728915662651
Epochs without improvement: 3
Epoch 31 complete in 73.0131356716156 seconds
	Train rv:
		loss: 0.13861200213432312
		acc: 0.9625
	Val rv:
		loss: 3.7931442260742188
		acc: 0.45444277108433734
Epochs without improvement: 4
Epoch 32 complete in 74.20154523849487 seconds
	Train rv:
		loss: 0.13878129422664642
		acc: 0.9633522727272728
	Val rv:
		loss: 3.8527438640594482
		acc: 0.4740210843373494
New best model found.
Epoch 33 complete in 73.59714913368225 seconds
	Train rv:
		loss: 0.11126993596553802
		acc: 0.971875
	Val rv:
		loss: 4.076095104217529
		acc: 0.4807981927710843
New best model found.
Epoch 34 complete in 73.2310299873352 seconds
	Train rv:
		loss: 0.1643364131450653
		acc: 0.9541666666666667
	Val rv:
		loss: 3.5671136379241943
		acc: 0.4506777108433735
Epochs without improvement: 1
Epoch 35 complete in 73.52641463279724 seconds
	Train rv:
		loss: 0.19273428618907928
		acc: 0.9447916666666667
	Val rv:
		loss: 4.0062642097473145
		acc: 0.4762801204819277
Epochs without improvement: 2
Epoch 36 complete in 72.67492699623108 seconds
	Train rv:
		loss: 0.11712461709976196
		acc: 0.968655303030303
	Val rv:
		loss: 4.0126543045043945
		acc: 0.4627259036144578
Epochs without improvement: 3
Epoch 37 complete in 72.5181531906128 seconds
	Train rv:
		loss: 0.12511812150478363
		acc: 0.965719696969697
	Val rv:
		loss: 4.0476789474487305
		acc: 0.4664909638554217
Epochs without improvement: 4
Epoch 38 complete in 72.77084994316101 seconds
	Train rv:
		loss: 0.17357034981250763
		acc: 0.9553977272727273
	Val rv:
		loss: 3.6677939891815186
		acc: 0.44126506024096385
Epochs without improvement: 5
Epoch 39 complete in 73.75832748413086 seconds
	Train rv:
		loss: 0.3432616591453552
		acc: 0.9029356060606061
	Val rv:
		loss: 3.4785594940185547
		acc: 0.4868222891566265
New best model found.
Epoch 40 complete in 75.03035163879395 seconds
	Train rv:
		loss: 0.08661577850580215
		acc: 0.9777462121212122
	Val rv:
		loss: 3.3687527179718018
		acc: 0.49021084337349397
New best model found.
Epoch 41 complete in 76.20288968086243 seconds
	Train rv:
		loss: 0.06262370944023132
		acc: 0.9865530303030303
	Val rv:
		loss: 3.1747097969055176
		acc: 0.5086596385542169
New best model found.
Epoch 42 complete in 76.87949848175049 seconds
	Train rv:
		loss: 0.05076821520924568
		acc: 0.9886363636363636
	Val rv:
		loss: 3.3863587379455566
		acc: 0.5139307228915663
New best model found.
Epoch 43 complete in 76.30036640167236 seconds
	Train rv:
		loss: 0.07068884372711182
		acc: 0.98125
	Val rv:
		loss: 4.021971702575684
		acc: 0.4401355421686747
Epochs without improvement: 1
Epoch 44 complete in 76.73063445091248 seconds
	Train rv:
		loss: 0.2398526519536972
		acc: 0.9250946969696969
	Val rv:
		loss: 3.924405097961426
		acc: 0.4751506024096386
Epochs without improvement: 2
Epoch 45 complete in 76.87407112121582 seconds
	Train rv:
		loss: 0.1377743035554886
		acc: 0.9601325757575757
	Val rv:
		loss: 4.2227582931518555
		acc: 0.45707831325301207
Epochs without improvement: 3
Epoch 46 complete in 76.25741600990295 seconds
	Train rv:
		loss: 0.13270246982574463
		acc: 0.9625
	Val rv:
		loss: 3.705267906188965
		acc: 0.47816265060240964
Epochs without improvement: 4
Epoch 47 complete in 76.42796611785889 seconds
	Train rv:
		loss: 0.10977831482887268
		acc: 0.9705492424242425
	Val rv:
		loss: 3.735264539718628
		acc: 0.4807981927710843
Epochs without improvement: 5
Epoch 48 complete in 77.81834363937378 seconds
	Train rv:
		loss: 0.09628426283597946
		acc: 0.9710227272727273
	Val rv:
		loss: 4.088603973388672
		acc: 0.4691265060240964
Epochs without improvement: 6
Epoch 49 complete in 77.38128113746643 seconds
	Train rv:
		loss: 0.1118994727730751
		acc: 0.968560606060606
	Val rv:
		loss: 3.959514617919922
		acc: 0.4612198795180723
Epochs without improvement: 7
Epoch 50 complete in 78.06477522850037 seconds
	Train rv:
		loss: 0.0911053717136383
		acc: 0.975284090909091
	Val rv:
		loss: 3.7315545082092285
		acc: 0.4875753012048193
Epochs without improvement: 8
Epoch 51 complete in 77.65721726417542 seconds
	Train rv:
		loss: 0.09851796925067902
		acc: 0.9723484848484848
	Val rv:
		loss: 3.660627603530884
		acc: 0.5067771084337349
Epochs without improvement: 9
Epoch 52 complete in 77.77687883377075 seconds
	Train rv:
		loss: 0.12174266576766968
		acc: 0.965625
	Val rv:
		loss: 4.3389506340026855
		acc: 0.48870481927710846
Epochs without improvement: 10
Epoch 53 complete in 77.5757348537445 seconds
	Train rv:
		loss: 0.13693174719810486
		acc: 0.9602272727272727
	Val rv:
		loss: 3.2804462909698486
		acc: 0.4894578313253012
Epochs without improvement: 11
Epoch 54 complete in 77.83974051475525 seconds
	Train rv:
		loss: 0.07209441810846329
		acc: 0.9803030303030303
	Val rv:
		loss: 4.0394439697265625
		acc: 0.48418674698795183
Epochs without improvement: 12
Epoch 55 complete in 77.54032135009766 seconds
	Train rv:
		loss: 0.05211905762553215
		acc: 0.9870265151515152
	Val rv:
		loss: 3.429628610610962
		acc: 0.5105421686746988
Epochs without improvement: 13
Epoch 56 complete in 77.09224486351013 seconds
	Train rv:
		loss: 0.09363605827093124
		acc: 0.974905303030303
	Val rv:
		loss: 4.146831035614014
		acc: 0.4740210843373494
Epochs without improvement: 14
Epoch 57 complete in 78.16681432723999 seconds
	Train rv:
		loss: 0.14171859622001648
		acc: 0.9589015151515151
	Val rv:
		loss: 4.129928112030029
		acc: 0.46875
Epochs without improvement: 15
Epoch 58 complete in 77.85726761817932 seconds
	Train rv:
		loss: 0.09123925119638443
		acc: 0.9754734848484848
	Val rv:
		loss: 3.3955702781677246
		acc: 0.4954819277108434
Epochs without improvement: 16
Epoch 59 complete in 77.24145603179932 seconds
	Train rv:
		loss: 0.08606649190187454
		acc: 0.9756628787878788
	Val rv:
		loss: 3.6981141567230225
		acc: 0.4894578313253012
Epochs without improvement: 17
Epoch 60 complete in 76.93947291374207 seconds
	Train rv:
		loss: 0.07895088195800781
		acc: 0.9774621212121212
	Val rv:
		loss: 3.858553647994995
		acc: 0.47853915662650603
Epochs without improvement: 18
Epoch 61 complete in 76.98276257514954 seconds
	Train rv:
		loss: 0.07356345653533936
		acc: 0.9799242424242425
	Val rv:
		loss: 3.8053817749023438
		acc: 0.48531626506024095
Epochs without improvement: 19
Epoch 62 complete in 76.82949495315552 seconds
	Train rv:
		loss: 0.05030258744955063
		acc: 0.9867424242424242
	Val rv:
		loss: 3.3796558380126953
		acc: 0.49585843373493976
Epochs without improvement: 20
Epoch 63 complete in 77.69147229194641 seconds
	Train rv:
		loss: 0.050117481499910355
		acc: 0.9875
	Val rv:
		loss: 3.8129405975341797
		acc: 0.4864457831325301
Epochs without improvement: 21
Epoch 64 complete in 77.21623277664185 seconds
	Train rv:
		loss: 0.168979674577713
		acc: 0.9476325757575758
	Val rv:
		loss: 3.5928304195404053
		acc: 0.473644578313253
Epochs without improvement: 22
Epoch 65 complete in 77.37450170516968 seconds
	Train rv:
		loss: 0.09035827964544296
		acc: 0.9742424242424242
	Val rv:
		loss: 3.8716933727264404
		acc: 0.4792921686746988
Epochs without improvement: 23
Epoch 66 complete in 77.19450616836548 seconds
	Train rv:
		loss: 0.10893765091896057
		acc: 0.9690340909090909
	Val rv:
		loss: 4.0223846435546875
		acc: 0.4924698795180723
Epochs without improvement: 24
Epoch 67 complete in 77.97017908096313 seconds
	Train rv:
		loss: 0.07549653202295303
		acc: 0.9776515151515152
	Val rv:
		loss: 3.966705322265625
		acc: 0.47853915662650603
Epochs without improvement: 25
Epoch 68 complete in 77.75841951370239 seconds
	Train rv:
		loss: 0.06657254695892334
		acc: 0.9808712121212121
	Val rv:
		loss: 3.76951003074646
		acc: 0.47213855421686746
Epochs without improvement: 26
Epoch 69 complete in 77.52772402763367 seconds
	Train rv:
		loss: 0.1504897177219391
		acc: 0.9571022727272728
	Val rv:
		loss: 4.1832122802734375
		acc: 0.47251506024096385
Epochs without improvement: 27
Epoch 70 complete in 78.0187087059021 seconds
	Train rv:
		loss: 0.0514129102230072
		acc: 0.9859848484848485
	Val rv:
		loss: 3.4734761714935303
		acc: 0.47740963855421686
Epochs without improvement: 28
Epoch 71 complete in 77.94113039970398 seconds
	Train rv:
		loss: 0.07477474957704544
		acc: 0.9776515151515152
	Val rv:
		loss: 3.917174816131592
		acc: 0.4924698795180723
Epochs without improvement: 29
Epoch 72 complete in 77.53426718711853 seconds
	Train rv:
		loss: 0.07198925316333771
		acc: 0.9796401515151515
	Val rv:
		loss: 3.921109199523926
		acc: 0.48493975903614456
Epochs without improvement: 30
Epoch 73 complete in 77.66140747070312 seconds
	Train rv:
		loss: 0.07182716578245163
		acc: 0.9800189393939394
	Val rv:
		loss: 3.7618775367736816
		acc: 0.48832831325301207
Epochs without improvement: 31
Epoch 74 complete in 76.89604473114014 seconds
	Train rv:
		loss: 0.05898631736636162
		acc: 0.9836174242424243
	Val rv:
		loss: 3.7023532390594482
		acc: 0.5022590361445783
Epochs without improvement: 32
Epoch 75 complete in 77.34567427635193 seconds
	Train rv:
		loss: 0.08996577560901642
		acc: 0.9721590909090909
	Val rv:
		loss: 4.05244779586792
		acc: 0.46762048192771083
Epochs without improvement: 33
Epoch 76 complete in 77.73937273025513 seconds
	Train rv:
		loss: 0.08198484778404236
		acc: 0.9767045454545454
	Val rv:
		loss: 3.5112814903259277
		acc: 0.5022590361445783
Epochs without improvement: 34
Epoch 77 complete in 77.59071016311646 seconds
	Train rv:
		loss: 0.06185389310121536
		acc: 0.9825757575757575
	Val rv:
		loss: 3.9554309844970703
		acc: 0.48569277108433734
Epochs without improvement: 35
Epoch 78 complete in 77.29553484916687 seconds
	Train rv:
		loss: 0.0758233368396759
		acc: 0.9795454545454545
	Val rv:
		loss: 3.693528175354004
		acc: 0.49811746987951805
Epochs without improvement: 36
Epoch 79 complete in 77.41974377632141 seconds
	Train rv:
		loss: 0.043803390115499496
		acc: 0.9864583333333333
	Val rv:
		loss: 3.4370768070220947
		acc: 0.49585843373493976
Epochs without improvement: 37
Epoch 80 complete in 77.50138783454895 seconds
	Train rv:
		loss: 0.06902332603931427
		acc: 0.9791666666666666
	Val rv:
		loss: 3.9206440448760986
		acc: 0.4868222891566265
Epochs without improvement: 38
Epoch 81 complete in 77.09900045394897 seconds
	Train rv:
		loss: 0.13394805788993835
		acc: 0.9605113636363637
	Val rv:
		loss: 3.794083595275879
		acc: 0.4766566265060241
Epochs without improvement: 39
Epoch 82 complete in 77.06598377227783 seconds
	Train rv:
		loss: 0.06649625301361084
		acc: 0.9795454545454545
	Val rv:
		loss: 3.9019956588745117
		acc: 0.49661144578313254
Epochs without improvement: 40
Epoch 83 complete in 77.46642971038818 seconds
	Train rv:
		loss: 0.049162495881319046
		acc: 0.9861742424242425
	Val rv:
		loss: 3.8991646766662598
		acc: 0.49661144578313254
Epochs without improvement: 41
Epoch 84 complete in 76.94967770576477 seconds
	Train rv:
		loss: 0.03808223083615303
		acc: 0.9890151515151515
	Val rv:
		loss: 3.6542868614196777
		acc: 0.5007530120481928
Epochs without improvement: 42
Epoch 85 complete in 77.07281684875488 seconds
	Train rv:
		loss: 0.031244827434420586
		acc: 0.9901515151515151
	Val rv:
		loss: 3.691176176071167
		acc: 0.514683734939759
New best model found.
Epoch 86 complete in 76.79137635231018 seconds
	Train rv:
		loss: 0.03607961907982826
		acc: 0.9888257575757575
	Val rv:
		loss: 3.583909273147583
		acc: 0.46724397590361444
Epochs without improvement: 1
Epoch 87 complete in 77.32587909698486 seconds
	Train rv:
		loss: 0.17715802788734436
		acc: 0.9443181818181818
	Val rv:
		loss: 3.6653409004211426
		acc: 0.5
Epochs without improvement: 2
Epoch 88 complete in 76.90712237358093 seconds
	Train rv:
		loss: 0.08190374821424484
		acc: 0.9765151515151516
	Val rv:
		loss: 3.7708511352539062
		acc: 0.49698795180722893
Epochs without improvement: 3
Epoch 89 complete in 77.58703899383545 seconds
	Train rv:
		loss: 0.0638033002614975
		acc: 0.9803977272727272
	Val rv:
		loss: 4.677896022796631
		acc: 0.45218373493975905
Epochs without improvement: 4
Epoch 90 complete in 77.63531732559204 seconds
	Train rv:
		loss: 0.10046977549791336
		acc: 0.9712121212121212
	Val rv:
		loss: 3.6883699893951416
		acc: 0.5071536144578314
Epochs without improvement: 5
Epoch 91 complete in 77.18208432197571 seconds
	Train rv:
		loss: 0.034485749900341034
		acc: 0.9893939393939394
	Val rv:
		loss: 3.548666000366211
		acc: 0.509789156626506
Epochs without improvement: 6
Epoch 92 complete in 77.09377479553223 seconds
	Train rv:
		loss: 0.0348580926656723
		acc: 0.9899621212121212
	Val rv:
		loss: 3.2610433101654053
		acc: 0.5109186746987951
Epochs without improvement: 7
Epoch 93 complete in 77.139657497406 seconds
	Train rv:
		loss: 0.026881003752350807
		acc: 0.9912878787878788
	Val rv:
		loss: 2.838700532913208
		acc: 0.5252259036144579
New best model found.
Epoch 94 complete in 77.2251763343811 seconds
	Train rv:
		loss: 0.021537572145462036
		acc: 0.9915719696969697
	Val rv:
		loss: 3.153001070022583
		acc: 0.5210843373493976
Epochs without improvement: 1
Epoch 95 complete in 77.11846256256104 seconds
	Train rv:
		loss: 0.021531179547309875
		acc: 0.9921401515151516
	Val rv:
		loss: 3.2587924003601074
		acc: 0.5229668674698795
Epochs without improvement: 2
Epoch 96 complete in 76.37449407577515 seconds
	Train rv:
		loss: 0.16281439363956451
		acc: 0.9520833333333333
	Val rv:
		loss: 3.1055705547332764
		acc: 0.45293674698795183
Epochs without improvement: 3
Epoch 97 complete in 77.33264923095703 seconds
	Train rv:
		loss: 0.18134205043315887
		acc: 0.9453598484848484
	Val rv:
		loss: 3.3770787715911865
		acc: 0.47063253012048195
Epochs without improvement: 4
Epoch 98 complete in 78.26600646972656 seconds
	Train rv:
		loss: 0.08640249818563461
		acc: 0.9730113636363636
	Val rv:
		loss: 3.768221616744995
		acc: 0.4973644578313253
Epochs without improvement: 5
Epoch 99 complete in 77.49264311790466 seconds
	Train rv:
		loss: 0.0409248061478138
		acc: 0.9880681818181818
	Val rv:
		loss: 3.086041212081909
		acc: 0.5240963855421686
Epochs without improvement: 6
Epoch 100 complete in 76.67811107635498 seconds
	Train rv:
		loss: 0.027129653841257095
		acc: 0.9914772727272727
	Val rv:
		loss: 3.172450065612793
		acc: 0.5229668674698795
Epochs without improvement: 7
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.OfficeHome'> with domain Clipart held out.
Training a feature extractor.
Save dir: ./results/OfficeHome/omit_Clipart/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.OfficeHome'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['Art', 'Product', 'Real World'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 69.25119137763977 seconds
	Train rv:
		loss: 4.414061546325684
		acc: 0.02546708185053381
	Val rv:
		loss: 4.072214126586914
		acc: 0.043133802816901406
New best model found.
Epoch 2 complete in 68.34664344787598 seconds
	Train rv:
		loss: 3.9901187419891357
		acc: 0.04959964412811388
	Val rv:
		loss: 3.9287302494049072
		acc: 0.061179577464788734
New best model found.
Epoch 3 complete in 68.12117743492126 seconds
	Train rv:
		loss: 3.8821356296539307
		acc: 0.06783807829181494
	Val rv:
		loss: 3.8502860069274902
		acc: 0.07174295774647887
New best model found.
Epoch 4 complete in 68.0320737361908 seconds
	Train rv:
		loss: 3.7864608764648438
		acc: 0.0894889024161828
	Val rv:
		loss: 3.724440336227417
		acc: 0.09419014084507042
New best model found.
Epoch 5 complete in 67.99782681465149 seconds
	Train rv:
		loss: 3.64670467376709
		acc: 0.11685240681775613
	Val rv:
		loss: 3.6062264442443848
		acc: 0.11267605633802817
New best model found.
Epoch 6 complete in 68.30409932136536 seconds
	Train rv:
		loss: 3.4886388778686523
		acc: 0.14795022476119124
	Val rv:
		loss: 3.5175716876983643
		acc: 0.14084507042253522
New best model found.
Epoch 7 complete in 68.21311855316162 seconds
	Train rv:
		loss: 3.327622890472412
		acc: 0.1789778048323656
	Val rv:
		loss: 3.364394187927246
		acc: 0.19058098591549297
New best model found.
Epoch 8 complete in 69.27873682975769 seconds
	Train rv:
		loss: 3.154712677001953
		acc: 0.21612193294624463
	Val rv:
		loss: 3.2895073890686035
		acc: 0.1857394366197183
Epochs without improvement: 1
Epoch 9 complete in 68.13943719863892 seconds
	Train rv:
		loss: 3.0047829151153564
		acc: 0.2522359056002997
	Val rv:
		loss: 3.1347005367279053
		acc: 0.24779929577464788
New best model found.
Epoch 10 complete in 68.68311285972595 seconds
	Train rv:
		loss: 2.8273415565490723
		acc: 0.2841121932946245
	Val rv:
		loss: 3.0207302570343018
		acc: 0.25616197183098594
New best model found.
Epoch 11 complete in 68.51239609718323 seconds
	Train rv:
		loss: 2.6229636669158936
		acc: 0.33708910844727474
	Val rv:
		loss: 2.8879332542419434
		acc: 0.3023767605633803
New best model found.
Epoch 12 complete in 67.95716857910156 seconds
	Train rv:
		loss: 2.4664905071258545
		acc: 0.37452589436224015
	Val rv:
		loss: 2.8281102180480957
		acc: 0.3173415492957746
New best model found.
Epoch 13 complete in 68.25974798202515 seconds
	Train rv:
		loss: 2.2882702350616455
		acc: 0.4076020790410189
	Val rv:
		loss: 2.7452657222747803
		acc: 0.3477112676056338
New best model found.
Epoch 14 complete in 68.73761463165283 seconds
	Train rv:
		loss: 2.0765843391418457
		acc: 0.4583079696572392
	Val rv:
		loss: 2.7267343997955322
		acc: 0.3543133802816901
New best model found.
Epoch 15 complete in 68.63762664794922 seconds
	Train rv:
		loss: 1.9102839231491089
		acc: 0.49686856152837616
	Val rv:
		loss: 2.8041577339172363
		acc: 0.3516725352112676
Epochs without improvement: 1
Epoch 16 complete in 68.67594790458679 seconds
	Train rv:
		loss: 1.6913578510284424
		acc: 0.5406033433227196
	Val rv:
		loss: 2.7587854862213135
		acc: 0.3767605633802817
New best model found.
Epoch 17 complete in 68.06889319419861 seconds
	Train rv:
		loss: 1.4831061363220215
		acc: 0.5923276830867203
	Val rv:
		loss: 2.681079626083374
		acc: 0.386443661971831
New best model found.
Epoch 18 complete in 68.63713002204895 seconds
	Train rv:
		loss: 1.2912991046905518
		acc: 0.6403352687769245
	Val rv:
		loss: 3.147125244140625
		acc: 0.3855633802816901
Epochs without improvement: 1
Epoch 19 complete in 68.59108138084412 seconds
	Train rv:
		loss: 1.0826585292816162
		acc: 0.683748126990073
	Val rv:
		loss: 2.9720160961151123
		acc: 0.3930457746478873
New best model found.
Epoch 20 complete in 68.49363422393799 seconds
	Train rv:
		loss: 0.8637749552726746
		acc: 0.7458735250046825
	Val rv:
		loss: 3.471034049987793
		acc: 0.3578345070422535
Epochs without improvement: 1
Epoch 21 complete in 68.70545482635498 seconds
	Train rv:
		loss: 0.6842667460441589
		acc: 0.8006707716800899
	Val rv:
		loss: 3.7119691371917725
		acc: 0.3842429577464789
Epochs without improvement: 2
Epoch 22 complete in 68.4757342338562 seconds
	Train rv:
		loss: 0.5679947137832642
		acc: 0.8272850721108822
	Val rv:
		loss: 3.5373928546905518
		acc: 0.4110915492957746
New best model found.
Epoch 23 complete in 68.48118209838867 seconds
	Train rv:
		loss: 0.44488874077796936
		acc: 0.8636156115377411
	Val rv:
		loss: 4.187727451324463
		acc: 0.36795774647887325
Epochs without improvement: 1
Epoch 24 complete in 69.05080723762512 seconds
	Train rv:
		loss: 0.3495519161224365
		acc: 0.8929340700505712
	Val rv:
		loss: 4.1696014404296875
		acc: 0.4097711267605634
Epochs without improvement: 2
Epoch 25 complete in 68.23775434494019 seconds
	Train rv:
		loss: 0.3145453929901123
		acc: 0.9057641880501967
	Val rv:
		loss: 4.267080783843994
		acc: 0.40008802816901406
Epochs without improvement: 3
Epoch 26 complete in 68.46331644058228 seconds
	Train rv:
		loss: 0.268472820520401
		acc: 0.9241899232065929
	Val rv:
		loss: 4.525424003601074
		acc: 0.40360915492957744
Epochs without improvement: 4
Epoch 27 complete in 68.28150510787964 seconds
	Train rv:
		loss: 0.26894083619117737
		acc: 0.9222993538115751
	Val rv:
		loss: 4.321765899658203
		acc: 0.4014084507042254
Epochs without improvement: 5
Epoch 28 complete in 68.98357939720154 seconds
	Train rv:
		loss: 0.22228607535362244
		acc: 0.9326418805019665
	Val rv:
		loss: 4.548482418060303
		acc: 0.4005281690140845
Epochs without improvement: 6
Epoch 29 complete in 68.18188810348511 seconds
	Train rv:
		loss: 0.22585302591323853
		acc: 0.9340115190110507
	Val rv:
		loss: 4.471683025360107
		acc: 0.4084507042253521
Epochs without improvement: 7
Epoch 30 complete in 68.24351859092712 seconds
	Train rv:
		loss: 0.1745462268590927
		acc: 0.948064946619217
	Val rv:
		loss: 4.416848659515381
		acc: 0.3886443661971831
Epochs without improvement: 8
Epoch 31 complete in 68.83567261695862 seconds
	Train rv:
		loss: 0.1677045077085495
		acc: 0.9548077823562465
	Val rv:
		loss: 4.551262855529785
		acc: 0.3970070422535211
Epochs without improvement: 9
Epoch 32 complete in 68.24000978469849 seconds
	Train rv:
		loss: 0.17862540483474731
		acc: 0.9477313167259787
	Val rv:
		loss: 4.880983352661133
		acc: 0.3926056338028169
Epochs without improvement: 10
Epoch 33 complete in 68.30418276786804 seconds
	Train rv:
		loss: 0.17365287244319916
		acc: 0.950657894736842
	Val rv:
		loss: 4.349490642547607
		acc: 0.3956866197183099
Epochs without improvement: 11
Epoch 34 complete in 68.48422265052795 seconds
	Train rv:
		loss: 0.1456548571586609
		acc: 0.9591098520322157
	Val rv:
		loss: 4.728940486907959
		acc: 0.4128521126760563
New best model found.
Epoch 35 complete in 68.65357327461243 seconds
	Train rv:
		loss: 0.18595723807811737
		acc: 0.9436516669788348
	Val rv:
		loss: 3.953791618347168
		acc: 0.40669014084507044
Epochs without improvement: 1
Epoch 36 complete in 68.01653838157654 seconds
	Train rv:
		loss: 0.1510186791419983
		acc: 0.9582962633451957
	Val rv:
		loss: 4.8537211418151855
		acc: 0.41725352112676056
New best model found.
Epoch 37 complete in 68.53214716911316 seconds
	Train rv:
		loss: 0.11239785701036453
		acc: 0.9695284697508897
	Val rv:
		loss: 4.65442419052124
		acc: 0.4273767605633803
New best model found.
Epoch 38 complete in 68.58867907524109 seconds
	Train rv:
		loss: 0.1171964704990387
		acc: 0.9685275800711743
	Val rv:
		loss: 5.139986515045166
		acc: 0.3816021126760563
Epochs without improvement: 1
Epoch 39 complete in 67.86920261383057 seconds
	Train rv:
		loss: 0.16874946653842926
		acc: 0.9529172129612287
	Val rv:
		loss: 4.38593864440918
		acc: 0.39436619718309857
Epochs without improvement: 2
Epoch 40 complete in 67.9389214515686 seconds
	Train rv:
		loss: 0.15730470418930054
		acc: 0.956552022850721
	Val rv:
		loss: 4.763528347015381
		acc: 0.394806338028169
Epochs without improvement: 3
Epoch 41 complete in 69.0683081150055 seconds
	Train rv:
		loss: 0.13155551254749298
		acc: 0.962855871886121
	Val rv:
		loss: 4.939894199371338
		acc: 0.4040492957746479
Epochs without improvement: 4
Epoch 42 complete in 68.39855575561523 seconds
	Train rv:
		loss: 0.1332044005393982
		acc: 0.9602980427046264
	Val rv:
		loss: 4.481361389160156
		acc: 0.383362676056338
Epochs without improvement: 5
Epoch 43 complete in 67.82824087142944 seconds
	Train rv:
		loss: 0.10924012959003448
		acc: 0.9710093182243865
	Val rv:
		loss: 5.273721218109131
		acc: 0.4027288732394366
Epochs without improvement: 6
Epoch 44 complete in 68.60943150520325 seconds
	Train rv:
		loss: 0.143000528216362
		acc: 0.95888743210339
	Val rv:
		loss: 5.563775539398193
		acc: 0.39524647887323944
Epochs without improvement: 7
Epoch 45 complete in 69.9891471862793 seconds
	Train rv:
		loss: 0.08089210838079453
		acc: 0.9784252669039146
	Val rv:
		loss: 4.88175106048584
		acc: 0.40889084507042256
Epochs without improvement: 8
Epoch 46 complete in 68.00221753120422 seconds
	Train rv:
		loss: 0.08746925741434097
		acc: 0.9771258662670911
	Val rv:
		loss: 4.956782817840576
		acc: 0.4027288732394366
Epochs without improvement: 9
Epoch 47 complete in 68.52991890907288 seconds
	Train rv:
		loss: 0.14138853549957275
		acc: 0.9573656115377411
	Val rv:
		loss: 5.214871883392334
		acc: 0.38776408450704225
Epochs without improvement: 10
Epoch 48 complete in 68.2620530128479 seconds
	Train rv:
		loss: 0.13990622758865356
		acc: 0.9599644128113879
	Val rv:
		loss: 4.569756507873535
		acc: 0.4119718309859155
Epochs without improvement: 11
Epoch 49 complete in 68.78510403633118 seconds
	Train rv:
		loss: 0.09983908385038376
		acc: 0.9717526690391459
	Val rv:
		loss: 5.198741436004639
		acc: 0.40713028169014087
Epochs without improvement: 12
Epoch 50 complete in 68.23463487625122 seconds
	Train rv:
		loss: 0.0928456038236618
		acc: 0.97393589623525
	Val rv:
		loss: 4.438805103302002
		acc: 0.4097711267605634
Epochs without improvement: 13
Epoch 51 complete in 67.7015495300293 seconds
	Train rv:
		loss: 0.1038033589720726
		acc: 0.9721975088967971
	Val rv:
		loss: 4.714170455932617
		acc: 0.41241197183098594
Epochs without improvement: 14
Epoch 52 complete in 68.50167775154114 seconds
	Train rv:
		loss: 0.117867112159729
		acc: 0.9631895017793595
	Val rv:
		loss: 4.778200149536133
		acc: 0.40889084507042256
Epochs without improvement: 15
Epoch 53 complete in 68.48526167869568 seconds
	Train rv:
		loss: 0.12201940268278122
		acc: 0.965337610039333
	Val rv:
		loss: 5.073323726654053
		acc: 0.3970070422535211
Epochs without improvement: 16
Epoch 54 complete in 68.38831830024719 seconds
	Train rv:
		loss: 0.11190395057201385
		acc: 0.9661160797902227
	Val rv:
		loss: 4.9081950187683105
		acc: 0.3816021126760563
Epochs without improvement: 17
Epoch 55 complete in 68.0733072757721 seconds
	Train rv:
		loss: 0.1053767204284668
		acc: 0.9687090279078479
	Val rv:
		loss: 4.6368255615234375
		acc: 0.4242957746478873
Epochs without improvement: 18
Epoch 56 complete in 68.31583189964294 seconds
	Train rv:
		loss: 0.08188057690858841
		acc: 0.9771609852032216
	Val rv:
		loss: 4.710394382476807
		acc: 0.4040492957746479
Epochs without improvement: 19
Epoch 57 complete in 68.39197778701782 seconds
	Train rv:
		loss: 0.09852518886327744
		acc: 0.9712668570893426
	Val rv:
		loss: 4.843164443969727
		acc: 0.40713028169014087
Epochs without improvement: 20
Epoch 58 complete in 69.3629744052887 seconds
	Train rv:
		loss: 0.06571783870458603
		acc: 0.9819839857651246
	Val rv:
		loss: 4.6534199714660645
		acc: 0.4225352112676056
Epochs without improvement: 21
Epoch 59 complete in 68.12094044685364 seconds
	Train rv:
		loss: 0.04768579080700874
		acc: 0.9885804926016106
	Val rv:
		loss: 4.597225666046143
		acc: 0.42649647887323944
Epochs without improvement: 22
Epoch 60 complete in 68.53790974617004 seconds
	Train rv:
		loss: 0.12544934451580048
		acc: 0.9645240213523132
	Val rv:
		loss: 4.519354343414307
		acc: 0.3965669014084507
Epochs without improvement: 23
Epoch 61 complete in 68.13556241989136 seconds
	Train rv:
		loss: 0.13326629996299744
		acc: 0.9610004214272334
	Val rv:
		loss: 4.405040740966797
		acc: 0.4163732394366197
Epochs without improvement: 24
Epoch 62 complete in 68.30319166183472 seconds
	Train rv:
		loss: 0.07582544535398483
		acc: 0.9766049353811576
	Val rv:
		loss: 4.896815299987793
		acc: 0.4198943661971831
Epochs without improvement: 25
Epoch 63 complete in 68.62485647201538 seconds
	Train rv:
		loss: 0.07833150029182434
		acc: 0.9778692170818505
	Val rv:
		loss: 4.869847774505615
		acc: 0.41065140845070425
Epochs without improvement: 26
Epoch 64 complete in 67.91673111915588 seconds
	Train rv:
		loss: 0.10621894150972366
		acc: 0.9704181494661922
	Val rv:
		loss: 4.649153709411621
		acc: 0.4234154929577465
Epochs without improvement: 27
Epoch 65 complete in 68.45313882827759 seconds
	Train rv:
		loss: 0.07260776311159134
		acc: 0.9817615658362989
	Val rv:
		loss: 4.613831043243408
		acc: 0.4154929577464789
Epochs without improvement: 28
Epoch 66 complete in 69.066565990448 seconds
	Train rv:
		loss: 0.07583250105381012
		acc: 0.9795373665480427
	Val rv:
		loss: 4.623136043548584
		acc: 0.4203345070422535
Epochs without improvement: 29
Epoch 67 complete in 68.31766819953918 seconds
	Train rv:
		loss: 0.08793970942497253
		acc: 0.9741992882562278
	Val rv:
		loss: 4.7645769119262695
		acc: 0.40713028169014087
Epochs without improvement: 30
Epoch 68 complete in 69.0499746799469 seconds
	Train rv:
		loss: 0.093303382396698
		acc: 0.9716765780108634
	Val rv:
		loss: 4.875553607940674
		acc: 0.40625
Epochs without improvement: 31
Epoch 69 complete in 68.1696982383728 seconds
	Train rv:
		loss: 0.1083751916885376
		acc: 0.9686387900355872
	Val rv:
		loss: 4.606432914733887
		acc: 0.4352992957746479
New best model found.
Epoch 70 complete in 68.61018371582031 seconds
	Train rv:
		loss: 0.0510566420853138
		acc: 0.9867660142348754
	Val rv:
		loss: 4.471059799194336
		acc: 0.42869718309859156
Epochs without improvement: 1
Epoch 71 complete in 68.99006390571594 seconds
	Train rv:
		loss: 0.030853664502501488
		acc: 0.9933274021352313
	Val rv:
		loss: 3.846126079559326
		acc: 0.42297535211267606
Epochs without improvement: 2
Epoch 72 complete in 68.95653748512268 seconds
	Train rv:
		loss: 0.020554210990667343
		acc: 0.9954403914590747
	Val rv:
		loss: 3.9387035369873047
		acc: 0.4397007042253521
New best model found.
Epoch 73 complete in 69.67300128936768 seconds
	Train rv:
		loss: 0.016824698075652122
		acc: 0.9957740213523132
	Val rv:
		loss: 4.009807109832764
		acc: 0.4339788732394366
Epochs without improvement: 1
Epoch 74 complete in 69.75071740150452 seconds
	Train rv:
		loss: 0.017101643607020378
		acc: 0.9955516014234875
	Val rv:
		loss: 3.884606122970581
		acc: 0.4476232394366197
New best model found.
Epoch 75 complete in 69.323814868927 seconds
	Train rv:
		loss: 0.0161761287599802
		acc: 0.9955516014234875
	Val rv:
		loss: 3.7771756649017334
		acc: 0.4590669014084507
New best model found.
Epoch 76 complete in 68.87916326522827 seconds
	Train rv:
		loss: 0.017656663432717323
		acc: 0.9954403914590747
	Val rv:
		loss: 4.020782470703125
		acc: 0.44938380281690143
Epochs without improvement: 1
Epoch 77 complete in 68.91926431655884 seconds
	Train rv:
		loss: 0.16627907752990723
		acc: 0.9532918149466192
	Val rv:
		loss: 4.534989833831787
		acc: 0.3613556338028169
Epochs without improvement: 2
Epoch 78 complete in 68.65306377410889 seconds
	Train rv:
		loss: 0.31910091638565063
		acc: 0.9058402790784791
	Val rv:
		loss: 4.548981666564941
		acc: 0.41065140845070425
Epochs without improvement: 3
Epoch 79 complete in 69.37064504623413 seconds
	Train rv:
		loss: 0.10049975663423538
		acc: 0.9714541580820377
	Val rv:
		loss: 4.692049503326416
		acc: 0.4198943661971831
Epochs without improvement: 4
Epoch 80 complete in 68.7412805557251 seconds
	Train rv:
		loss: 0.09369747340679169
		acc: 0.9706347162389961
	Val rv:
		loss: 4.685980796813965
		acc: 0.4084507042253521
Epochs without improvement: 5
Epoch 81 complete in 68.76815366744995 seconds
	Train rv:
		loss: 0.08306296914815903
		acc: 0.9757913466941374
	Val rv:
		loss: 4.658472061157227
		acc: 0.4216549295774648
Epochs without improvement: 6
Epoch 82 complete in 70.02562260627747 seconds
	Train rv:
		loss: 0.04211077839136124
		acc: 0.988767793594306
	Val rv:
		loss: 4.363006591796875
		acc: 0.43705985915492956
Epochs without improvement: 7
Epoch 83 complete in 69.75042390823364 seconds
	Train rv:
		loss: 0.025114720687270164
		acc: 0.9945507117437722
	Val rv:
		loss: 3.845759391784668
		acc: 0.45026408450704225
Epochs without improvement: 8
Epoch 84 complete in 69.23343443870544 seconds
	Train rv:
		loss: 0.02024807408452034
		acc: 0.9950306705375538
	Val rv:
		loss: 4.091193199157715
		acc: 0.43838028169014087
Epochs without improvement: 9
Epoch 85 complete in 68.73981380462646 seconds
	Train rv:
		loss: 0.09280222654342651
		acc: 0.9743104982206405
	Val rv:
		loss: 4.546594619750977
		acc: 0.40184859154929575
Epochs without improvement: 10
Epoch 86 complete in 68.25134229660034 seconds
	Train rv:
		loss: 0.16749164462089539
		acc: 0.9502891459074733
	Val rv:
		loss: 4.507312297821045
		acc: 0.40492957746478875
Epochs without improvement: 11
Epoch 87 complete in 67.86187887191772 seconds
	Train rv:
		loss: 0.10550544410943985
		acc: 0.969821127551976
	Val rv:
		loss: 4.208232402801514
		acc: 0.3930457746478873
Epochs without improvement: 12
Epoch 88 complete in 68.41542863845825 seconds
	Train rv:
		loss: 0.0678711086511612
		acc: 0.9812055160142349
	Val rv:
		loss: 4.822559356689453
		acc: 0.4300176056338028
Epochs without improvement: 13
Epoch 89 complete in 68.61933827400208 seconds
	Train rv:
		loss: 0.05384838581085205
		acc: 0.9853554036336392
	Val rv:
		loss: 4.693845748901367
		acc: 0.4128521126760563
Epochs without improvement: 14
Epoch 90 complete in 68.69371795654297 seconds
	Train rv:
		loss: 0.05929011479020119
		acc: 0.983540925266904
	Val rv:
		loss: 5.063021659851074
		acc: 0.4128521126760563
Epochs without improvement: 15
Epoch 91 complete in 69.33521056175232 seconds
	Train rv:
		loss: 0.06034313514828682
		acc: 0.9827624555160143
	Val rv:
		loss: 4.887599468231201
		acc: 0.417693661971831
Epochs without improvement: 16
Epoch 92 complete in 68.74113321304321 seconds
	Train rv:
		loss: 0.07130267471075058
		acc: 0.9797597864768683
	Val rv:
		loss: 4.900052547454834
		acc: 0.4216549295774648
Epochs without improvement: 17
Epoch 93 complete in 68.14661526679993 seconds
	Train rv:
		loss: 0.03630660101771355
		acc: 0.9903247330960854
	Val rv:
		loss: 4.51548433303833
		acc: 0.4234154929577465
Epochs without improvement: 18
Epoch 94 complete in 69.05894255638123 seconds
	Train rv:
		loss: 0.059259895235300064
		acc: 0.9830960854092526
	Val rv:
		loss: 5.1947503089904785
		acc: 0.41725352112676056
Epochs without improvement: 19
Epoch 95 complete in 68.84657406806946 seconds
	Train rv:
		loss: 0.07643117755651474
		acc: 0.9776819160891551
	Val rv:
		loss: 4.810003757476807
		acc: 0.40713028169014087
Epochs without improvement: 20
Epoch 96 complete in 68.99174356460571 seconds
	Train rv:
		loss: 0.05493716523051262
		acc: 0.9842081850533808
	Val rv:
		loss: 5.110209941864014
		acc: 0.4044894366197183
Epochs without improvement: 21
Epoch 97 complete in 68.02443861961365 seconds
	Train rv:
		loss: 0.029937392100691795
		acc: 0.9925489323843416
	Val rv:
		loss: 4.578286170959473
		acc: 0.42077464788732394
Epochs without improvement: 22
Epoch 98 complete in 68.47209978103638 seconds
	Train rv:
		loss: 0.10123273730278015
		acc: 0.9708981082599737
	Val rv:
		loss: 4.645636558532715
		acc: 0.3939260563380282
Epochs without improvement: 23
Epoch 99 complete in 68.62182831764221 seconds
	Train rv:
		loss: 0.10426308959722519
		acc: 0.9697508896797153
	Val rv:
		loss: 4.714357376098633
		acc: 0.4238556338028169
Epochs without improvement: 24
Epoch 100 complete in 68.15776920318604 seconds
	Train rv:
		loss: 0.05594191700220108
		acc: 0.983540925266904
	Val rv:
		loss: 4.373193740844727
		acc: 0.4216549295774648
Epochs without improvement: 25
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.OfficeHome'> with domain Product held out.
Training a feature extractor.
Save dir: ./results/OfficeHome/omit_Product/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.OfficeHome'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['Art', 'Clipart', 'Real World'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 69.37699747085571 seconds
	Train rv:
		loss: 4.433471202850342
		acc: 0.029607228195937873
	Val rv:
		loss: 4.145355224609375
		acc: 0.02993197278911565
New best model found.
Epoch 2 complete in 67.52871656417847 seconds
	Train rv:
		loss: 4.081532955169678
		acc: 0.041591995221027474
	Val rv:
		loss: 4.017984867095947
		acc: 0.059842687074829926
New best model found.
Epoch 3 complete in 68.35290098190308 seconds
	Train rv:
		loss: 4.00901985168457
		acc: 0.05574223416965352
	Val rv:
		loss: 3.9596805572509766
		acc: 0.057823129251700675
Epochs without improvement: 1
Epoch 4 complete in 67.27451705932617 seconds
	Train rv:
		loss: 3.9356541633605957
		acc: 0.06679360812425329
	Val rv:
		loss: 3.9955623149871826
		acc: 0.05960884353741496
Epochs without improvement: 2
Epoch 5 complete in 68.00871896743774 seconds
	Train rv:
		loss: 3.846863031387329
		acc: 0.07948775388291517
	Val rv:
		loss: 3.8045475482940674
		acc: 0.08864795918367348
New best model found.
Epoch 6 complete in 69.14082360267639 seconds
	Train rv:
		loss: 3.774052619934082
		acc: 0.09524342891278374
	Val rv:
		loss: 3.7483162879943848
		acc: 0.10875850340136055
New best model found.
Epoch 7 complete in 68.41282820701599 seconds
	Train rv:
		loss: 3.6750645637512207
		acc: 0.11163381123058544
	Val rv:
		loss: 3.6993155479431152
		acc: 0.11296768707482993
New best model found.
Epoch 8 complete in 68.47784399986267 seconds
	Train rv:
		loss: 3.5576999187469482
		acc: 0.13172043010752688
	Val rv:
		loss: 3.4729416370391846
		acc: 0.14936224489795918
New best model found.
Epoch 9 complete in 68.68776059150696 seconds
	Train rv:
		loss: 3.3986449241638184
		acc: 0.1639784946236559
	Val rv:
		loss: 3.5016708374023438
		acc: 0.1399872448979592
Epochs without improvement: 1
Epoch 10 complete in 69.01318049430847 seconds
	Train rv:
		loss: 3.2330703735351562
		acc: 0.1975806451612903
	Val rv:
		loss: 3.31190824508667
		acc: 0.19156037414965985
New best model found.
Epoch 11 complete in 67.99213409423828 seconds
	Train rv:
		loss: 3.0691494941711426
		acc: 0.23237753882915171
	Val rv:
		loss: 3.2806601524353027
		acc: 0.19781037414965985
New best model found.
Epoch 12 complete in 68.55316734313965 seconds
	Train rv:
		loss: 2.8878817558288574
		acc: 0.27001194743130225
	Val rv:
		loss: 3.106616735458374
		acc: 0.2373299319727891
New best model found.
Epoch 13 complete in 68.30303382873535 seconds
	Train rv:
		loss: 2.6965558528900146
		acc: 0.3088784348864994
	Val rv:
		loss: 3.0015599727630615
		acc: 0.24917091836734692
New best model found.
Epoch 14 complete in 68.13495326042175 seconds
	Train rv:
		loss: 2.4855422973632812
		acc: 0.36103643966547194
	Val rv:
		loss: 2.9174416065216064
		acc: 0.27818877551020404
New best model found.
Epoch 15 complete in 68.67249774932861 seconds
	Train rv:
		loss: 2.2799041271209717
		acc: 0.402479091995221
	Val rv:
		loss: 2.895941734313965
		acc: 0.2967261904761905
New best model found.
Epoch 16 complete in 68.66937375068665 seconds
	Train rv:
		loss: 2.059356689453125
		acc: 0.44885005973715647
	Val rv:
		loss: 2.8173091411590576
		acc: 0.3275085034013605
New best model found.
Epoch 17 complete in 68.16022443771362 seconds
	Train rv:
		loss: 1.812973141670227
		acc: 0.505973715651135
	Val rv:
		loss: 2.843085289001465
		acc: 0.33622448979591835
New best model found.
Epoch 18 complete in 69.31824326515198 seconds
	Train rv:
		loss: 1.5947617292404175
		acc: 0.5595131421744325
	Val rv:
		loss: 3.029386520385742
		acc: 0.33509778911564625
Epochs without improvement: 1
Epoch 19 complete in 69.06003999710083 seconds
	Train rv:
		loss: 1.3272485733032227
		acc: 0.618018219832736
	Val rv:
		loss: 3.1663084030151367
		acc: 0.3507440476190476
New best model found.
Epoch 20 complete in 68.22385501861572 seconds
	Train rv:
		loss: 1.1019641160964966
		acc: 0.6935483870967742
	Val rv:
		loss: 3.3054349422454834
		acc: 0.3580994897959184
New best model found.
Epoch 21 complete in 69.01279187202454 seconds
	Train rv:
		loss: 0.8869913816452026
		acc: 0.7400686977299881
	Val rv:
		loss: 3.6282999515533447
		acc: 0.34672619047619047
Epochs without improvement: 1
Epoch 22 complete in 68.61106634140015 seconds
	Train rv:
		loss: 0.7377876043319702
		acc: 0.7816606929510156
	Val rv:
		loss: 3.5988051891326904
		acc: 0.3585671768707483
New best model found.
Epoch 23 complete in 68.69765043258667 seconds
	Train rv:
		loss: 0.5513170957565308
		acc: 0.836768219832736
	Val rv:
		loss: 4.011540412902832
		acc: 0.36972789115646254
New best model found.
Epoch 24 complete in 68.9979145526886 seconds
	Train rv:
		loss: 0.4340136647224426
		acc: 0.8709304062126642
	Val rv:
		loss: 4.080072402954102
		acc: 0.35765306122448975
Epochs without improvement: 1
Epoch 25 complete in 69.33752179145813 seconds
	Train rv:
		loss: 0.35241150856018066
		acc: 0.8945639187574671
	Val rv:
		loss: 4.734187602996826
		acc: 0.3534438775510204
Epochs without improvement: 2
Epoch 26 complete in 68.51835179328918 seconds
	Train rv:
		loss: 0.35880914330482483
		acc: 0.8918757467144564
	Val rv:
		loss: 4.445472717285156
		acc: 0.3838010204081632
New best model found.
Epoch 27 complete in 67.64828443527222 seconds
	Train rv:
		loss: 0.25443971157073975
		acc: 0.9259259259259258
	Val rv:
		loss: 4.391839027404785
		acc: 0.37215136054421766
Epochs without improvement: 1
Epoch 28 complete in 68.1814215183258 seconds
	Train rv:
		loss: 0.2581096291542053
		acc: 0.9270086618876943
	Val rv:
		loss: 5.1017231941223145
		acc: 0.3632440476190476
Epochs without improvement: 2
Epoch 29 complete in 68.07008719444275 seconds
	Train rv:
		loss: 0.21953555941581726
		acc: 0.9427270011947431
	Val rv:
		loss: 4.547641277313232
		acc: 0.38737244897959183
New best model found.
Epoch 30 complete in 67.5078673362732 seconds
	Train rv:
		loss: 0.19473472237586975
		acc: 0.9475059737156512
	Val rv:
		loss: 4.80388879776001
		acc: 0.375531462585034
Epochs without improvement: 1
Epoch 31 complete in 67.94040489196777 seconds
	Train rv:
		loss: 0.19290469586849213
		acc: 0.9432123655913979
	Val rv:
		loss: 4.8764848709106445
		acc: 0.38737244897959183
Epochs without improvement: 2
Epoch 32 complete in 67.58897829055786 seconds
	Train rv:
		loss: 0.20238597691059113
		acc: 0.9409348864994026
	Val rv:
		loss: 4.66468620300293
		acc: 0.3782100340136054
Epochs without improvement: 3
Epoch 33 complete in 68.44661259651184 seconds
	Train rv:
		loss: 0.18059484660625458
		acc: 0.949895459976105
	Val rv:
		loss: 4.995143413543701
		acc: 0.38871173469387754
New best model found.
Epoch 34 complete in 68.29482674598694 seconds
	Train rv:
		loss: 0.13874875009059906
		acc: 0.9656137992831542
	Val rv:
		loss: 4.801215171813965
		acc: 0.3833333333333333
Epochs without improvement: 1
Epoch 35 complete in 68.3331151008606 seconds
	Train rv:
		loss: 0.2015044391155243
		acc: 0.9416069295101552
	Val rv:
		loss: 4.391465663909912
		acc: 0.3701743197278911
Epochs without improvement: 2
Epoch 36 complete in 67.92751741409302 seconds
	Train rv:
		loss: 0.1894090175628662
		acc: 0.9475806451612904
	Val rv:
		loss: 4.801754951477051
		acc: 0.3813350340136054
Epochs without improvement: 3
Epoch 37 complete in 68.05262804031372 seconds
	Train rv:
		loss: 0.14537189900875092
		acc: 0.9594534050179212
	Val rv:
		loss: 4.364306449890137
		acc: 0.38558673469387755
Epochs without improvement: 4
Epoch 38 complete in 68.3648533821106 seconds
	Train rv:
		loss: 0.1306234896183014
		acc: 0.9636350059737158
	Val rv:
		loss: 4.979374885559082
		acc: 0.3798044217687075
Epochs without improvement: 5
Epoch 39 complete in 68.42843770980835 seconds
	Train rv:
		loss: 0.1294429898262024
		acc: 0.9652777777777778
	Val rv:
		loss: 4.793212890625
		acc: 0.3858205782312925
Epochs without improvement: 6
Epoch 40 complete in 68.09899568557739 seconds
	Train rv:
		loss: 0.19022931158542633
		acc: 0.9468339307048985
	Val rv:
		loss: 4.851910591125488
		acc: 0.3922831632653061
New best model found.
Epoch 41 complete in 68.58177185058594 seconds
	Train rv:
		loss: 0.15503515303134918
		acc: 0.9571759259259258
	Val rv:
		loss: 4.523697853088379
		acc: 0.394281462585034
New best model found.
Epoch 42 complete in 67.87076926231384 seconds
	Train rv:
		loss: 0.14167334139347076
		acc: 0.959378733572282
	Val rv:
		loss: 4.838476181030273
		acc: 0.38422619047619044
Epochs without improvement: 1
Epoch 43 complete in 67.36713433265686 seconds
	Train rv:
		loss: 0.16547733545303345
		acc: 0.9504554958183989
	Val rv:
		loss: 4.783530235290527
		acc: 0.3904974489795918
Epochs without improvement: 2
Epoch 44 complete in 68.79798579216003 seconds
	Train rv:
		loss: 0.10677273571491241
		acc: 0.9706541218637993
	Val rv:
		loss: 4.772256851196289
		acc: 0.3976190476190476
New best model found.
Epoch 45 complete in 68.60420775413513 seconds
	Train rv:
		loss: 0.18421664834022522
		acc: 0.9484020310633214
	Val rv:
		loss: 4.402871608734131
		acc: 0.38892431972789115
Epochs without improvement: 1
Epoch 46 complete in 67.60439276695251 seconds
	Train rv:
		loss: 0.08937416225671768
		acc: 0.975918458781362
	Val rv:
		loss: 5.204047679901123
		acc: 0.3810799319727891
Epochs without improvement: 2
Epoch 47 complete in 68.11173009872437 seconds
	Train rv:
		loss: 0.0964520201086998
		acc: 0.9769265232974911
	Val rv:
		loss: 4.316146373748779
		acc: 0.3857993197278911
Epochs without improvement: 3
Epoch 48 complete in 67.64675378799438 seconds
	Train rv:
		loss: 0.10335664451122284
		acc: 0.972894265232975
	Val rv:
		loss: 4.602112770080566
		acc: 0.38131377551020407
Epochs without improvement: 4
Epoch 49 complete in 68.27391719818115 seconds
	Train rv:
		loss: 0.17346397042274475
		acc: 0.9475433094384706
	Val rv:
		loss: 4.546494960784912
		acc: 0.39117772108843535
Epochs without improvement: 5
Epoch 50 complete in 68.30057144165039 seconds
	Train rv:
		loss: 0.12013578414916992
		acc: 0.9667712066905616
	Val rv:
		loss: 4.806422233581543
		acc: 0.37842261904761904
Epochs without improvement: 6
Epoch 51 complete in 68.63485598564148 seconds
	Train rv:
		loss: 0.13204844295978546
		acc: 0.963149641577061
	Val rv:
		loss: 4.544558048248291
		acc: 0.3860119047619047
Epochs without improvement: 7
Epoch 52 complete in 68.152019739151 seconds
	Train rv:
		loss: 0.12312371283769608
		acc: 0.9642323775388291
	Val rv:
		loss: 5.359524726867676
		acc: 0.3878188775510204
Epochs without improvement: 8
Epoch 53 complete in 68.71526098251343 seconds
	Train rv:
		loss: 0.09996861219406128
		acc: 0.971960872162485
	Val rv:
		loss: 4.713398456573486
		acc: 0.38758503401360545
Epochs without improvement: 9
Epoch 54 complete in 67.60686469078064 seconds
	Train rv:
		loss: 0.13074944913387299
		acc: 0.9612081839904419
	Val rv:
		loss: 5.215433597564697
		acc: 0.3730654761904762
Epochs without improvement: 10
Epoch 55 complete in 68.81184577941895 seconds
	Train rv:
		loss: 0.1209648996591568
		acc: 0.9645683990442054
	Val rv:
		loss: 4.602310657501221
		acc: 0.38758503401360545
Epochs without improvement: 11
Epoch 56 complete in 70.1340012550354 seconds
	Train rv:
		loss: 0.07104794681072235
		acc: 0.9809587813620072
	Val rv:
		loss: 4.326310157775879
		acc: 0.38979591836734695
Epochs without improvement: 12
Epoch 57 complete in 68.7479956150055 seconds
	Train rv:
		loss: 0.06942202895879745
		acc: 0.9821161887694146
	Val rv:
		loss: 4.845455646514893
		acc: 0.3960459183673469
Epochs without improvement: 13
Epoch 58 complete in 69.4364070892334 seconds
	Train rv:
		loss: 0.14426098763942719
		acc: 0.9588560334528076
	Val rv:
		loss: 5.040961265563965
		acc: 0.37127976190476186
Epochs without improvement: 14
Epoch 59 complete in 68.33743333816528 seconds
	Train rv:
		loss: 0.14294514060020447
		acc: 0.9577359617682197
	Val rv:
		loss: 4.839623928070068
		acc: 0.38692602040816326
Epochs without improvement: 15
Epoch 60 complete in 68.17578482627869 seconds
	Train rv:
		loss: 0.10460484772920609
		acc: 0.9706541218637993
	Val rv:
		loss: 4.502426624298096
		acc: 0.37463860544217686
Epochs without improvement: 16
Epoch 61 complete in 68.79582738876343 seconds
	Train rv:
		loss: 0.07843995839357376
		acc: 0.9783452807646356
	Val rv:
		loss: 4.8700666427612305
		acc: 0.38356717687074826
Epochs without improvement: 17
Epoch 62 complete in 68.18022441864014 seconds
	Train rv:
		loss: 0.11357170343399048
		acc: 0.9665098566308243
	Val rv:
		loss: 4.962965488433838
		acc: 0.36413690476190474
Epochs without improvement: 18
Epoch 63 complete in 68.9860315322876 seconds
	Train rv:
		loss: 0.09953933954238892
		acc: 0.9702060931899642
	Val rv:
		loss: 4.993784427642822
		acc: 0.3808673469387755
Epochs without improvement: 19
Epoch 64 complete in 69.0044960975647 seconds
	Train rv:
		loss: 0.05428260937333107
		acc: 0.9861111111111112
	Val rv:
		loss: 4.8174591064453125
		acc: 0.40588860544217686
New best model found.
Epoch 65 complete in 69.12749147415161 seconds
	Train rv:
		loss: 0.043648600578308105
		acc: 0.9877912186379928
	Val rv:
		loss: 4.3552398681640625
		acc: 0.4085671768707483
New best model found.
Epoch 66 complete in 68.56459307670593 seconds
	Train rv:
		loss: 0.035671405494213104
		acc: 0.9886872759856631
	Val rv:
		loss: 3.916472911834717
		acc: 0.425531462585034
New best model found.
Epoch 67 complete in 69.10788631439209 seconds
	Train rv:
		loss: 0.037828993052244186
		acc: 0.9878285543608125
	Val rv:
		loss: 3.9346601963043213
		acc: 0.4112457482993197
Epochs without improvement: 1
Epoch 68 complete in 69.54295992851257 seconds
	Train rv:
		loss: 0.06583376228809357
		acc: 0.979876045400239
	Val rv:
		loss: 5.228503704071045
		acc: 0.3418154761904762
Epochs without improvement: 2
Epoch 69 complete in 67.94575095176697 seconds
	Train rv:
		loss: 0.32650691270828247
		acc: 0.9007243130227001
	Val rv:
		loss: 4.741048336029053
		acc: 0.3784438775510204
Epochs without improvement: 3
Epoch 70 complete in 69.23346018791199 seconds
	Train rv:
		loss: 0.13348351418972015
		acc: 0.9605734767025089
	Val rv:
		loss: 5.119524955749512
		acc: 0.38356717687074826
Epochs without improvement: 4
Epoch 71 complete in 68.30746793746948 seconds
	Train rv:
		loss: 0.09974294900894165
		acc: 0.9708408004778972
	Val rv:
		loss: 4.770759582519531
		acc: 0.3985331632653061
Epochs without improvement: 5
Epoch 72 complete in 68.78010106086731 seconds
	Train rv:
		loss: 0.06565119326114655
		acc: 0.980137395459976
	Val rv:
		loss: 4.601159572601318
		acc: 0.4105867346938775
Epochs without improvement: 6
Epoch 73 complete in 69.35584616661072 seconds
	Train rv:
		loss: 0.08635163307189941
		acc: 0.9734543010752689
	Val rv:
		loss: 4.429768085479736
		acc: 0.3846938775510204
Epochs without improvement: 7
Epoch 74 complete in 68.99282789230347 seconds
	Train rv:
		loss: 0.11125968396663666
		acc: 0.9657258064516129
	Val rv:
		loss: 4.524750232696533
		acc: 0.3831207482993197
Epochs without improvement: 8
Epoch 75 complete in 68.35571599006653 seconds
	Train rv:
		loss: 0.07066121697425842
		acc: 0.9783452807646356
	Val rv:
		loss: 5.119227409362793
		acc: 0.39719387755102037
Epochs without improvement: 9
Epoch 76 complete in 69.64039015769958 seconds
	Train rv:
		loss: 0.04168442636728287
		acc: 0.9875672043010753
	Val rv:
		loss: 4.1584086418151855
		acc: 0.4143920068027211
Epochs without improvement: 10
Epoch 77 complete in 68.65255999565125 seconds
	Train rv:
		loss: 0.07135972380638123
		acc: 0.9794653524492234
	Val rv:
		loss: 4.7395429611206055
		acc: 0.394281462585034
Epochs without improvement: 11
Epoch 78 complete in 68.32919478416443 seconds
	Train rv:
		loss: 0.11169067770242691
		acc: 0.9681899641577061
	Val rv:
		loss: 5.526792049407959
		acc: 0.36994047619047615
Epochs without improvement: 12
Epoch 79 complete in 68.20154547691345 seconds
	Train rv:
		loss: 0.13272029161453247
		acc: 0.9575119474313022
	Val rv:
		loss: 4.4905219078063965
		acc: 0.37976190476190474
Epochs without improvement: 13
Epoch 80 complete in 69.30247044563293 seconds
	Train rv:
		loss: 0.10097546875476837
		acc: 0.9705421146953405
	Val rv:
		loss: 4.4600830078125
		acc: 0.40255102040816326
Epochs without improvement: 14
Epoch 81 complete in 68.53785991668701 seconds
	Train rv:
		loss: 0.05173071473836899
		acc: 0.985103046594982
	Val rv:
		loss: 4.692715167999268
		acc: 0.41526360544217683
Epochs without improvement: 15
Epoch 82 complete in 68.91714549064636 seconds
	Train rv:
		loss: 0.03272587060928345
		acc: 0.9894339904420549
	Val rv:
		loss: 4.1586408615112305
		acc: 0.41481717687074826
Epochs without improvement: 16
Epoch 83 complete in 69.00950217247009 seconds
	Train rv:
		loss: 0.029113875702023506
		acc: 0.9893593189964157
	Val rv:
		loss: 4.249899864196777
		acc: 0.419281462585034
Epochs without improvement: 17
Epoch 84 complete in 68.97786355018616 seconds
	Train rv:
		loss: 0.028674840927124023
		acc: 0.9890232974910395
	Val rv:
		loss: 4.099996089935303
		acc: 0.4190688775510204
Epochs without improvement: 18
Epoch 85 complete in 68.85484719276428 seconds
	Train rv:
		loss: 0.02700042352080345
		acc: 0.9891353046594982
	Val rv:
		loss: 4.29204797744751
		acc: 0.42130102040816325
Epochs without improvement: 19
Epoch 86 complete in 69.20780539512634 seconds
	Train rv:
		loss: 0.028993798419833183
		acc: 0.9894713261648745
	Val rv:
		loss: 4.16079044342041
		acc: 0.40767431972789114
Epochs without improvement: 20
Epoch 87 complete in 68.47276854515076 seconds
	Train rv:
		loss: 0.3520689904689789
		acc: 0.8957959976105137
	Val rv:
		loss: 4.21337890625
		acc: 0.4003188775510204
Epochs without improvement: 21
Epoch 88 complete in 68.76426911354065 seconds
	Train rv:
		loss: 0.08653280138969421
		acc: 0.974350358422939
	Val rv:
		loss: 4.746123790740967
		acc: 0.3929421768707483
Epochs without improvement: 22
Epoch 89 complete in 69.53512692451477 seconds
	Train rv:
		loss: 0.11929260939359665
		acc: 0.9643443847072879
	Val rv:
		loss: 5.14979362487793
		acc: 0.40901360544217685
Epochs without improvement: 23
Epoch 90 complete in 69.06973886489868 seconds
	Train rv:
		loss: 0.05371381342411041
		acc: 0.9848790322580645
	Val rv:
		loss: 4.296014308929443
		acc: 0.40389030612244897
Epochs without improvement: 24
Epoch 91 complete in 69.34278583526611 seconds
	Train rv:
		loss: 0.04111744090914726
		acc: 0.9864471326164874
	Val rv:
		loss: 4.8068132400512695
		acc: 0.4049957482993197
Epochs without improvement: 25
Epoch 92 complete in 68.29357862472534 seconds
	Train rv:
		loss: 0.04626568779349327
		acc: 0.9857004181600957
	Val rv:
		loss: 4.406366348266602
		acc: 0.4150297619047619
Epochs without improvement: 26
Epoch 93 complete in 68.31358194351196 seconds
	Train rv:
		loss: 0.028509078547358513
		acc: 0.9898073476702509
	Val rv:
		loss: 4.257383823394775
		acc: 0.41615646258503397
Epochs without improvement: 27
Epoch 94 complete in 68.60865235328674 seconds
	Train rv:
		loss: 0.028277041390538216
		acc: 0.9884632616487455
	Val rv:
		loss: 4.058085918426514
		acc: 0.4230654761904762
Epochs without improvement: 28
Epoch 95 complete in 68.5361704826355 seconds
	Train rv:
		loss: 0.19920660555362701
		acc: 0.9380600358422939
	Val rv:
		loss: 4.613532066345215
		acc: 0.3739795918367347
Epochs without improvement: 29
Epoch 96 complete in 68.94124412536621 seconds
	Train rv:
		loss: 0.13801300525665283
		acc: 0.9550851254480287
	Val rv:
		loss: 4.595476150512695
		acc: 0.39183673469387753
Epochs without improvement: 30
Epoch 97 complete in 68.67105770111084 seconds
	Train rv:
		loss: 0.07772691547870636
		acc: 0.9746490442054957
	Val rv:
		loss: 4.839964866638184
		acc: 0.4014243197278911
Epochs without improvement: 31
Epoch 98 complete in 68.4255599975586 seconds
	Train rv:
		loss: 0.04280942305922508
		acc: 0.9863724611708483
	Val rv:
		loss: 4.534549713134766
		acc: 0.40476190476190477
Epochs without improvement: 32
Epoch 99 complete in 68.91986417770386 seconds
	Train rv:
		loss: 0.031995341181755066
		acc: 0.9882019115890083
	Val rv:
		loss: 3.968062162399292
		acc: 0.416390306122449
Epochs without improvement: 33
Epoch 100 complete in 68.10042309761047 seconds
	Train rv:
		loss: 0.024220995604991913
		acc: 0.9898073476702509
	Val rv:
		loss: 4.6218791007995605
		acc: 0.41883503401360545
Epochs without improvement: 34
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.OfficeHome'> with domain Real World held out.
Training a feature extractor.
Save dir: ./results/OfficeHome/omit_Real World/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.OfficeHome'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['Art', 'Clipart', 'Product'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 64.93984127044678 seconds
	Train rv:
		loss: 4.459080696105957
		acc: 0.026023131672597864
	Val rv:
		loss: 4.112162113189697
		acc: 0.02640845070422535
New best model found.
Epoch 2 complete in 65.44821834564209 seconds
	Train rv:
		loss: 4.0486907958984375
		acc: 0.0421797153024911
	Val rv:
		loss: 3.9781200885772705
		acc: 0.05501760563380282
New best model found.
Epoch 3 complete in 65.26898503303528 seconds
	Train rv:
		loss: 3.9653234481811523
		acc: 0.05274466192170818
	Val rv:
		loss: 3.9300155639648438
		acc: 0.05721830985915493
New best model found.
Epoch 4 complete in 65.11073970794678 seconds
	Train rv:
		loss: 3.864023208618164
		acc: 0.0673932384341637
	Val rv:
		loss: 4.0214738845825195
		acc: 0.05868544600938968
New best model found.
Epoch 5 complete in 65.16061353683472 seconds
	Train rv:
		loss: 3.747486114501953
		acc: 0.09810053380782918
	Val rv:
		loss: 3.678100109100342
		acc: 0.10534037558685447
New best model found.
Epoch 6 complete in 65.42187643051147 seconds
	Train rv:
		loss: 3.575157403945923
		acc: 0.13130338078291814
	Val rv:
		loss: 3.5681867599487305
		acc: 0.13791079812206572
New best model found.
Epoch 7 complete in 65.35572814941406 seconds
	Train rv:
		loss: 3.3535802364349365
		acc: 0.17626334519572953
	Val rv:
		loss: 3.367983818054199
		acc: 0.17811032863849766
New best model found.
Epoch 8 complete in 65.07897353172302 seconds
	Train rv:
		loss: 3.1416893005371094
		acc: 0.22662366548042703
	Val rv:
		loss: 3.1803925037384033
		acc: 0.22256455399061034
New best model found.
Epoch 9 complete in 65.96785855293274 seconds
	Train rv:
		loss: 2.9422624111175537
		acc: 0.2697419928825623
	Val rv:
		loss: 3.158433437347412
		acc: 0.22065727699530516
Epochs without improvement: 1
Epoch 10 complete in 64.95419383049011 seconds
	Train rv:
		loss: 2.7299911975860596
		acc: 0.31095195729537367
	Val rv:
		loss: 3.102360486984253
		acc: 0.24633215962441313
New best model found.
Epoch 11 complete in 65.0741126537323 seconds
	Train rv:
		loss: 2.5042054653167725
		acc: 0.3684964412811388
	Val rv:
		loss: 2.8291709423065186
		acc: 0.30369718309859156
New best model found.
Epoch 12 complete in 64.8597764968872 seconds
	Train rv:
		loss: 2.2851223945617676
		acc: 0.4128336298932384
	Val rv:
		loss: 2.755945920944214
		acc: 0.33083920187793425
New best model found.
Epoch 13 complete in 65.82841062545776 seconds
	Train rv:
		loss: 2.058932065963745
		acc: 0.46429270462633454
	Val rv:
		loss: 2.848489761352539
		acc: 0.3414025821596244
New best model found.
Epoch 14 complete in 65.69856858253479 seconds
	Train rv:
		loss: 1.8432376384735107
		acc: 0.515911921708185
	Val rv:
		loss: 2.6607871055603027
		acc: 0.38013497652582157
New best model found.
Epoch 15 complete in 64.89654779434204 seconds
	Train rv:
		loss: 1.595017671585083
		acc: 0.5714857651245552
	Val rv:
		loss: 2.617748737335205
		acc: 0.3884976525821596
New best model found.
Epoch 16 complete in 64.8659451007843 seconds
	Train rv:
		loss: 1.3530616760253906
		acc: 0.630693950177936
	Val rv:
		loss: 2.758441209793091
		acc: 0.39803403755868544
New best model found.
Epoch 17 complete in 65.01476693153381 seconds
	Train rv:
		loss: 1.1561329364776611
		acc: 0.6747153024911032
	Val rv:
		loss: 2.9507017135620117
		acc: 0.4210680751173709
New best model found.
Epoch 18 complete in 64.80285596847534 seconds
	Train rv:
		loss: 0.9587583541870117
		acc: 0.7268238434163702
	Val rv:
		loss: 3.0186688899993896
		acc: 0.3997946009389671
Epochs without improvement: 1
Epoch 19 complete in 65.12083721160889 seconds
	Train rv:
		loss: 0.7738639712333679
		acc: 0.7792037366548044
	Val rv:
		loss: 3.147437334060669
		acc: 0.44468896713615025
New best model found.
Epoch 20 complete in 65.1494665145874 seconds
	Train rv:
		loss: 0.6286115050315857
		acc: 0.8145062277580071
	Val rv:
		loss: 3.314436674118042
		acc: 0.4325117370892019
Epochs without improvement: 1
Epoch 21 complete in 65.6152708530426 seconds
	Train rv:
		loss: 0.4868204891681671
		acc: 0.8604804270462634
	Val rv:
		loss: 4.062071800231934
		acc: 0.4219483568075117
Epochs without improvement: 2
Epoch 22 complete in 65.67295217514038 seconds
	Train rv:
		loss: 0.4401278793811798
		acc: 0.8711432384341636
	Val rv:
		loss: 3.802069902420044
		acc: 0.4505575117370892
New best model found.
Epoch 23 complete in 64.91880178451538 seconds
	Train rv:
		loss: 0.39031776785850525
		acc: 0.8862010676156584
	Val rv:
		loss: 3.7908923625946045
		acc: 0.4357394366197183
Epochs without improvement: 1
Epoch 24 complete in 65.00758576393127 seconds
	Train rv:
		loss: 0.31376996636390686
		acc: 0.9110008896797153
	Val rv:
		loss: 3.7544615268707275
		acc: 0.44454225352112675
Epochs without improvement: 2
Epoch 25 complete in 64.70890951156616 seconds
	Train rv:
		loss: 0.28455057740211487
		acc: 0.9209163701067616
	Val rv:
		loss: 3.880068063735962
		acc: 0.45892018779342725
New best model found.
Epoch 26 complete in 64.9177417755127 seconds
	Train rv:
		loss: 0.22937259078025818
		acc: 0.9362944839857651
	Val rv:
		loss: 3.6041250228881836
		acc: 0.4621478873239437
New best model found.
Epoch 27 complete in 64.93457889556885 seconds
	Train rv:
		loss: 0.19336818158626556
		acc: 0.9484475088967972
	Val rv:
		loss: 4.342371940612793
		acc: 0.4558392018779343
Epochs without improvement: 1
Epoch 28 complete in 65.06816935539246 seconds
	Train rv:
		loss: 0.2135366052389145
		acc: 0.9386476868327401
	Val rv:
		loss: 3.960609197616577
		acc: 0.4546654929577465
Epochs without improvement: 2
Epoch 29 complete in 64.72195506095886 seconds
	Train rv:
		loss: 0.17628024518489838
		acc: 0.9568683274021352
	Val rv:
		loss: 4.019043922424316
		acc: 0.443075117370892
Epochs without improvement: 3
Epoch 30 complete in 64.72212028503418 seconds
	Train rv:
		loss: 0.18057028949260712
		acc: 0.9525934163701066
	Val rv:
		loss: 4.082557201385498
		acc: 0.44630281690140844
Epochs without improvement: 4
Epoch 31 complete in 64.65184140205383 seconds
	Train rv:
		loss: 0.20137174427509308
		acc: 0.9416637010676158
	Val rv:
		loss: 4.100022792816162
		acc: 0.4470363849765258
Epochs without improvement: 5
Epoch 32 complete in 65.11932158470154 seconds
	Train rv:
		loss: 0.1991911083459854
		acc: 0.9433629893238433
	Val rv:
		loss: 4.255363941192627
		acc: 0.43779342723004694
Epochs without improvement: 6
Epoch 33 complete in 64.83085131645203 seconds
	Train rv:
		loss: 0.16229958832263947
		acc: 0.9598532028469751
	Val rv:
		loss: 4.119604110717773
		acc: 0.44615610328638494
Epochs without improvement: 7
Epoch 34 complete in 64.71567845344543 seconds
	Train rv:
		loss: 0.18139761686325073
		acc: 0.94855871886121
	Val rv:
		loss: 4.134830474853516
		acc: 0.44072769953051644
Epochs without improvement: 8
Epoch 35 complete in 64.84063839912415 seconds
	Train rv:
		loss: 0.15714657306671143
		acc: 0.9576467971530249
	Val rv:
		loss: 4.232481002807617
		acc: 0.45451877934272306
Epochs without improvement: 9
Epoch 36 complete in 65.40573167800903 seconds
	Train rv:
		loss: 0.14957834780216217
		acc: 0.959297153024911
	Val rv:
		loss: 4.2164154052734375
		acc: 0.45143779342723006
Epochs without improvement: 10
Epoch 37 complete in 65.06507682800293 seconds
	Train rv:
		loss: 0.11986947804689407
		acc: 0.9694172597864769
	Val rv:
		loss: 4.140865325927734
		acc: 0.457306338028169
Epochs without improvement: 11
Epoch 38 complete in 65.57260394096375 seconds
	Train rv:
		loss: 0.1146407499909401
		acc: 0.970053380782918
	Val rv:
		loss: 4.578207969665527
		acc: 0.46170774647887325
Epochs without improvement: 12
Epoch 39 complete in 65.03093409538269 seconds
	Train rv:
		loss: 0.1383780539035797
		acc: 0.9619039145907474
	Val rv:
		loss: 4.067590236663818
		acc: 0.46948356807511743
New best model found.
Epoch 40 complete in 65.22655868530273 seconds
	Train rv:
		loss: 0.1423390954732895
		acc: 0.9626334519572953
	Val rv:
		loss: 4.437963485717773
		acc: 0.44747652582159625
Epochs without improvement: 1
Epoch 41 complete in 64.89125275611877 seconds
	Train rv:
		loss: 0.15009626746177673
		acc: 0.957282028469751
	Val rv:
		loss: 4.237243175506592
		acc: 0.45011737089201875
Epochs without improvement: 2
Epoch 42 complete in 65.02999997138977 seconds
	Train rv:
		loss: 0.127977192401886
		acc: 0.964635231316726
	Val rv:
		loss: 4.19618034362793
		acc: 0.47065727699530513
New best model found.
Epoch 43 complete in 64.88300347328186 seconds
	Train rv:
		loss: 0.11825099587440491
		acc: 0.9698487544483987
	Val rv:
		loss: 4.453268051147461
		acc: 0.4496772300469483
Epochs without improvement: 1
Epoch 44 complete in 64.86739325523376 seconds
	Train rv:
		loss: 0.12653782963752747
		acc: 0.9641592526690391
	Val rv:
		loss: 3.7406883239746094
		acc: 0.45319835680751175
Epochs without improvement: 2
Epoch 45 complete in 64.9728569984436 seconds
	Train rv:
		loss: 0.1487107276916504
		acc: 0.9578514234875445
	Val rv:
		loss: 4.187297821044922
		acc: 0.44923708920187794
Epochs without improvement: 3
Epoch 46 complete in 64.86726069450378 seconds
	Train rv:
		loss: 0.10719593614339828
		acc: 0.9732784697508896
	Val rv:
		loss: 4.262500762939453
		acc: 0.469043427230047
Epochs without improvement: 4
Epoch 47 complete in 64.85497522354126 seconds
	Train rv:
		loss: 0.10715717077255249
		acc: 0.970720640569395
	Val rv:
		loss: 4.1799163818359375
		acc: 0.46288145539906106
Epochs without improvement: 5
Epoch 48 complete in 64.95581126213074 seconds
	Train rv:
		loss: 0.10669884830713272
		acc: 0.972864768683274
	Val rv:
		loss: 4.193841934204102
		acc: 0.46948356807511743
Epochs without improvement: 6
Epoch 49 complete in 65.0637149810791 seconds
	Train rv:
		loss: 0.11497467756271362
		acc: 0.9707517793594306
	Val rv:
		loss: 4.665724754333496
		acc: 0.46170774647887325
Epochs without improvement: 7
Epoch 50 complete in 65.04329466819763 seconds
	Train rv:
		loss: 0.1212136447429657
		acc: 0.9677980427046264
	Val rv:
		loss: 4.590358257293701
		acc: 0.457599765258216
Epochs without improvement: 8
Epoch 51 complete in 65.07353949546814 seconds
	Train rv:
		loss: 0.14881682395935059
		acc: 0.9558985765124556
	Val rv:
		loss: 3.8531808853149414
		acc: 0.45319835680751175
Epochs without improvement: 9
Epoch 52 complete in 64.89021611213684 seconds
	Train rv:
		loss: 0.12453480064868927
		acc: 0.9647153024911032
	Val rv:
		loss: 4.132243633270264
		acc: 0.4408744131455399
Epochs without improvement: 10
Epoch 53 complete in 65.46032309532166 seconds
	Train rv:
		loss: 0.11896156519651413
		acc: 0.9659697508896797
	Val rv:
		loss: 4.5365753173828125
		acc: 0.45715962441314556
Epochs without improvement: 11
Epoch 54 complete in 65.06966972351074 seconds
	Train rv:
		loss: 0.09674495458602905
		acc: 0.9736432384341637
	Val rv:
		loss: 4.245122909545898
		acc: 0.4672828638497653
Epochs without improvement: 12
Epoch 55 complete in 64.81491613388062 seconds
	Train rv:
		loss: 0.05786127969622612
		acc: 0.9860987544483986
	Val rv:
		loss: 3.993283987045288
		acc: 0.488262910798122
New best model found.
Epoch 56 complete in 65.23783326148987 seconds
	Train rv:
		loss: 0.03875623643398285
		acc: 0.9894039145907473
	Val rv:
		loss: 3.579899787902832
		acc: 0.48400821596244137
Epochs without improvement: 1
Epoch 57 complete in 64.77463793754578 seconds
	Train rv:
		loss: 0.03434734791517258
		acc: 0.9904359430604982
	Val rv:
		loss: 3.4251327514648438
		acc: 0.49266431924882625
New best model found.
Epoch 58 complete in 64.93911504745483 seconds
	Train rv:
		loss: 0.031282663345336914
		acc: 0.9904048042704625
	Val rv:
		loss: 3.1171209812164307
		acc: 0.4989730046948357
New best model found.
Epoch 59 complete in 64.74123191833496 seconds
	Train rv:
		loss: 0.031717345118522644
		acc: 0.9908807829181495
	Val rv:
		loss: 3.675323009490967
		acc: 0.4985328638497653
Epochs without improvement: 1
Epoch 60 complete in 64.92989253997803 seconds
	Train rv:
		loss: 0.2571161687374115
		acc: 0.9235676156583631
	Val rv:
		loss: 3.975790023803711
		acc: 0.4329518779342723
Epochs without improvement: 2
Epoch 61 complete in 64.69974613189697 seconds
	Train rv:
		loss: 0.23548714816570282
		acc: 0.9303514234875444
	Val rv:
		loss: 3.7192420959472656
		acc: 0.445862676056338
Epochs without improvement: 3
Epoch 62 complete in 65.03747510910034 seconds
	Train rv:
		loss: 0.125559002161026
		acc: 0.9632695729537366
	Val rv:
		loss: 3.9727706909179688
		acc: 0.4809272300469484
Epochs without improvement: 4
Epoch 63 complete in 66.1754219532013 seconds
	Train rv:
		loss: 0.07004543393850327
		acc: 0.9809830960854092
	Val rv:
		loss: 3.9975051879882812
		acc: 0.469043427230047
Epochs without improvement: 5
Epoch 64 complete in 66.10713982582092 seconds
	Train rv:
		loss: 0.05676300823688507
		acc: 0.9861788256227757
	Val rv:
		loss: 3.437174081802368
		acc: 0.49237089201877937
Epochs without improvement: 6
Epoch 65 complete in 66.3117527961731 seconds
	Train rv:
		loss: 0.03981144353747368
		acc: 0.9884341637010676
	Val rv:
		loss: 3.530165195465088
		acc: 0.4928110328638498
Epochs without improvement: 7
Epoch 66 complete in 65.22261881828308 seconds
	Train rv:
		loss: 0.05277738720178604
		acc: 0.985209074733096
	Val rv:
		loss: 4.188331604003906
		acc: 0.4716842723004695
Epochs without improvement: 8
Epoch 67 complete in 65.04646730422974 seconds
	Train rv:
		loss: 0.16905690729618073
		acc: 0.9524510676156585
	Val rv:
		loss: 4.121933937072754
		acc: 0.443368544600939
Epochs without improvement: 9
Epoch 68 complete in 65.10405826568604 seconds
	Train rv:
		loss: 0.14296236634254456
		acc: 0.957709074733096
	Val rv:
		loss: 4.08402681350708
		acc: 0.46713615023474175
Epochs without improvement: 10
Epoch 69 complete in 64.93829464912415 seconds
	Train rv:
		loss: 0.0647367388010025
		acc: 0.9830960854092526
	Val rv:
		loss: 4.250765323638916
		acc: 0.4747652582159625
Epochs without improvement: 11
Epoch 70 complete in 65.10613512992859 seconds
	Train rv:
		loss: 0.06383609771728516
		acc: 0.9833185053380783
	Val rv:
		loss: 3.979499578475952
		acc: 0.46464201877934275
Epochs without improvement: 12
Epoch 71 complete in 64.8961284160614 seconds
	Train rv:
		loss: 0.0821356475353241
		acc: 0.9772019572953736
	Val rv:
		loss: 4.115662097930908
		acc: 0.4496772300469483
Epochs without improvement: 13
Epoch 72 complete in 65.44637513160706 seconds
	Train rv:
		loss: 0.13797849416732788
		acc: 0.9586298932384342
	Val rv:
		loss: 4.20479679107666
		acc: 0.46434859154929575
Epochs without improvement: 14
Epoch 73 complete in 64.88352942466736 seconds
	Train rv:
		loss: 0.09800242632627487
		acc: 0.9713078291814946
	Val rv:
		loss: 4.345336437225342
		acc: 0.4482100938967136
Epochs without improvement: 15
Epoch 74 complete in 64.87144017219543 seconds
	Train rv:
		loss: 0.06950977444648743
		acc: 0.9809830960854092
	Val rv:
		loss: 3.639448642730713
		acc: 0.4598004694835681
Epochs without improvement: 16
Epoch 75 complete in 66.06861352920532 seconds
	Train rv:
		loss: 0.04484270140528679
		acc: 0.9876556939501779
	Val rv:
		loss: 3.8382439613342285
		acc: 0.48444835680751175
Epochs without improvement: 17
Epoch 76 complete in 66.31369280815125 seconds
	Train rv:
		loss: 0.05240383371710777
		acc: 0.9866548042704626
	Val rv:
		loss: 3.9687836170196533
		acc: 0.4747652582159625
Epochs without improvement: 18
Epoch 77 complete in 65.84969687461853 seconds
	Train rv:
		loss: 0.06273601204156876
		acc: 0.9815080071174377
	Val rv:
		loss: 4.169586181640625
		acc: 0.4301643192488263
Epochs without improvement: 19
Epoch 78 complete in 66.04330849647522 seconds
	Train rv:
		loss: 0.14668452739715576
		acc: 0.9556450177935943
	Val rv:
		loss: 3.8825817108154297
		acc: 0.45569248826291076
Epochs without improvement: 20
Epoch 79 complete in 66.93311071395874 seconds
	Train rv:
		loss: 0.08090581744909286
		acc: 0.9788701067615658
	Val rv:
		loss: 4.287579536437988
		acc: 0.47065727699530513
Epochs without improvement: 21
Epoch 80 complete in 66.123868227005 seconds
	Train rv:
		loss: 0.05171453580260277
		acc: 0.9852891459074732
	Val rv:
		loss: 4.036355972290039
		acc: 0.47036384976525825
Epochs without improvement: 22
Epoch 81 complete in 65.41484355926514 seconds
	Train rv:
		loss: 0.036914411932229996
		acc: 0.988959074733096
	Val rv:
		loss: 3.551577568054199
		acc: 0.4822476525821597
Epochs without improvement: 23
Epoch 82 complete in 65.1136863231659 seconds
	Train rv:
		loss: 0.04533391073346138
		acc: 0.9868772241992882
	Val rv:
		loss: 3.9284250736236572
		acc: 0.48576877934272306
Epochs without improvement: 24
Epoch 83 complete in 65.0236246585846 seconds
	Train rv:
		loss: 0.059219375252723694
		acc: 0.981588078291815
	Val rv:
		loss: 4.635619163513184
		acc: 0.431631455399061
Epochs without improvement: 25
Epoch 84 complete in 65.16451859474182 seconds
	Train rv:
		loss: 0.1979513168334961
		acc: 0.9384386120996442
	Val rv:
		loss: 4.320890426635742
		acc: 0.44439553990610325
Epochs without improvement: 26
Epoch 85 complete in 65.13310408592224 seconds
	Train rv:
		loss: 0.09720361232757568
		acc: 0.9695284697508897
	Val rv:
		loss: 4.61776065826416
		acc: 0.46860328638497656
Epochs without improvement: 27
Epoch 86 complete in 65.07049632072449 seconds
	Train rv:
		loss: 0.058037810027599335
		acc: 0.9819217081850534
	Val rv:
		loss: 4.04680871963501
		acc: 0.4677230046948357
Epochs without improvement: 28
Epoch 87 complete in 65.33077144622803 seconds
	Train rv:
		loss: 0.04605819284915924
		acc: 0.9865124555160142
	Val rv:
		loss: 3.7945828437805176
		acc: 0.49193075117370894
Epochs without improvement: 29
Epoch 88 complete in 64.90732526779175 seconds
	Train rv:
		loss: 0.031213119626045227
		acc: 0.9896574733096085
	Val rv:
		loss: 3.6159234046936035
		acc: 0.4879694835680751
Epochs without improvement: 30
Epoch 89 complete in 65.04008841514587 seconds
	Train rv:
		loss: 0.08183399587869644
		acc: 0.9747241992882562
	Val rv:
		loss: 4.865875720977783
		acc: 0.4487969483568075
Epochs without improvement: 31
Epoch 90 complete in 64.59892439842224 seconds
	Train rv:
		loss: 0.10655029863119125
		acc: 0.967464412811388
	Val rv:
		loss: 4.671730041503906
		acc: 0.45173122065727694
Epochs without improvement: 32
Epoch 91 complete in 65.69047594070435 seconds
	Train rv:
		loss: 0.08454865217208862
		acc: 0.9733096085409253
	Val rv:
		loss: 4.495643615722656
		acc: 0.46860328638497656
Epochs without improvement: 33
Epoch 92 complete in 66.13732361793518 seconds
	Train rv:
		loss: 0.04896748438477516
		acc: 0.9863211743772242
	Val rv:
		loss: 4.023064136505127
		acc: 0.4747652582159625
Epochs without improvement: 34
Epoch 93 complete in 64.33333778381348 seconds
	Train rv:
		loss: 0.0386723130941391
		acc: 0.9881005338078291
	Val rv:
		loss: 3.487755537033081
		acc: 0.4928110328638498
Epochs without improvement: 35
Epoch 94 complete in 64.75657486915588 seconds
	Train rv:
		loss: 0.030726995319128036
		acc: 0.9904048042704625
	Val rv:
		loss: 3.9883809089660645
		acc: 0.4681631455399061
Epochs without improvement: 36
Epoch 95 complete in 65.04681634902954 seconds
	Train rv:
		loss: 0.08863501995801926
		acc: 0.972864768683274
	Val rv:
		loss: 4.261890411376953
		acc: 0.44791666666666663
Epochs without improvement: 37
Epoch 96 complete in 64.63500237464905 seconds
	Train rv:
		loss: 0.13933010399341583
		acc: 0.9596797153024912
	Val rv:
		loss: 4.4528021812438965
		acc: 0.4307511737089202
Epochs without improvement: 38
Epoch 97 complete in 65.45710468292236 seconds
	Train rv:
		loss: 0.07515686750411987
		acc: 0.9778692170818505
	Val rv:
		loss: 3.9950320720672607
		acc: 0.4752053990610329
Epochs without improvement: 39
Epoch 98 complete in 64.72119069099426 seconds
	Train rv:
		loss: 0.04224540293216705
		acc: 0.987482206405694
	Val rv:
		loss: 3.7446975708007812
		acc: 0.4791666666666667
Epochs without improvement: 40
Epoch 99 complete in 64.69029927253723 seconds
	Train rv:
		loss: 0.026501618325710297
		acc: 0.9909919928825622
	Val rv:
		loss: 3.8413074016571045
		acc: 0.4936913145539906
Epochs without improvement: 41
Epoch 100 complete in 65.33140969276428 seconds
	Train rv:
		loss: 0.027581701055169106
		acc: 0.9893238434163701
	Val rv:
		loss: 3.4943809509277344
		acc: 0.4928110328638498
Epochs without improvement: 42
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.PACS'> with domain art_painting held out.
Training a feature extractor.
Save dir: ./results/PACS/omit_art_painting/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.PACS'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['cartoon', 'photo', 'sketch'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 45.631508350372314 seconds
	Train rv:
		loss: 2.4071288108825684
		acc: 0.23531307855064795
	Val rv:
		loss: 1.5881561040878296
		acc: 0.340625
New best model found.
Epoch 2 complete in 45.840630292892456 seconds
	Train rv:
		loss: 1.54719877243042
		acc: 0.36067673895794766
	Val rv:
		loss: 1.4889838695526123
		acc: 0.41450000000000004
New best model found.
Epoch 3 complete in 45.82511019706726 seconds
	Train rv:
		loss: 1.3599581718444824
		acc: 0.4663200872784978
	Val rv:
		loss: 1.3125463724136353
		acc: 0.473125
New best model found.
Epoch 4 complete in 45.845972537994385 seconds
	Train rv:
		loss: 1.2071292400360107
		acc: 0.5395398042845808
	Val rv:
		loss: 1.1700809001922607
		acc: 0.578375
New best model found.
Epoch 5 complete in 45.91106152534485 seconds
	Train rv:
		loss: 1.1238099336624146
		acc: 0.5796581592171383
	Val rv:
		loss: 1.1723874807357788
		acc: 0.555125
Epochs without improvement: 1
Epoch 6 complete in 45.909555435180664 seconds
	Train rv:
		loss: 1.0792620182037354
		acc: 0.5923614784448559
	Val rv:
		loss: 1.0999339818954468
		acc: 0.57575
Epochs without improvement: 2
Epoch 7 complete in 45.946964502334595 seconds
	Train rv:
		loss: 0.9847950339317322
		acc: 0.6316863924887596
	Val rv:
		loss: 0.9905216693878174
		acc: 0.63925
New best model found.
Epoch 8 complete in 45.85685706138611 seconds
	Train rv:
		loss: 0.8692157864570618
		acc: 0.6754992065591114
	Val rv:
		loss: 0.9302659630775452
		acc: 0.646125
New best model found.
Epoch 9 complete in 45.78822445869446 seconds
	Train rv:
		loss: 0.8351695537567139
		acc: 0.689938177730759
	Val rv:
		loss: 0.8450222611427307
		acc: 0.681875
New best model found.
Epoch 10 complete in 45.883665323257446 seconds
	Train rv:
		loss: 0.7740944623947144
		acc: 0.7160060169267389
	Val rv:
		loss: 0.9500333666801453
		acc: 0.6551250000000001
Epochs without improvement: 1
Epoch 11 complete in 46.28335762023926 seconds
	Train rv:
		loss: 0.7050353288650513
		acc: 0.7427102618354934
	Val rv:
		loss: 0.8092778921127319
		acc: 0.699625
New best model found.
Epoch 12 complete in 46.03330039978027 seconds
	Train rv:
		loss: 0.6352354884147644
		acc: 0.7654803623380059
	Val rv:
		loss: 0.8119062185287476
		acc: 0.7128749999999999
New best model found.
Epoch 13 complete in 45.98182439804077 seconds
	Train rv:
		loss: 0.5785136818885803
		acc: 0.7838617429251521
	Val rv:
		loss: 0.8559033274650574
		acc: 0.7015
Epochs without improvement: 1
Epoch 14 complete in 45.836169481277466 seconds
	Train rv:
		loss: 0.5416368842124939
		acc: 0.8058962576038085
	Val rv:
		loss: 0.8628028035163879
		acc: 0.7040000000000001
Epochs without improvement: 2
Epoch 15 complete in 46.170693159103394 seconds
	Train rv:
		loss: 0.4770011007785797
		acc: 0.8224923961914837
	Val rv:
		loss: 0.8597596883773804
		acc: 0.70075
Epochs without improvement: 3
Epoch 16 complete in 45.92267942428589 seconds
	Train rv:
		loss: 0.43461769819259644
		acc: 0.845055871462576
	Val rv:
		loss: 0.8664564490318298
		acc: 0.715375
New best model found.
Epoch 17 complete in 46.14597249031067 seconds
	Train rv:
		loss: 0.38754570484161377
		acc: 0.8568830997090716
	Val rv:
		loss: 0.9719671010971069
		acc: 0.713125
Epochs without improvement: 1
Epoch 18 complete in 46.52713871002197 seconds
	Train rv:
		loss: 0.326206237077713
		acc: 0.8822153530811955
	Val rv:
		loss: 1.2809398174285889
		acc: 0.6547499999999999
Epochs without improvement: 2
Epoch 19 complete in 45.8353054523468 seconds
	Train rv:
		loss: 0.31973958015441895
		acc: 0.8825790134884951
	Val rv:
		loss: 1.1610387563705444
		acc: 0.671125
Epochs without improvement: 3
Epoch 20 complete in 46.161909103393555 seconds
	Train rv:
		loss: 0.31344667077064514
		acc: 0.886199087542978
	Val rv:
		loss: 0.9365715980529785
		acc: 0.725625
New best model found.
Epoch 21 complete in 45.97080159187317 seconds
	Train rv:
		loss: 0.2293533831834793
		acc: 0.9196475800052896
	Val rv:
		loss: 1.2287242412567139
		acc: 0.7083750000000001
Epochs without improvement: 1
Epoch 22 complete in 45.944920778274536 seconds
	Train rv:
		loss: 0.24467971920967102
		acc: 0.9124735519703782
	Val rv:
		loss: 1.130345106124878
		acc: 0.722125
Epochs without improvement: 2
Epoch 23 complete in 46.167439222335815 seconds
	Train rv:
		loss: 0.19743476808071136
		acc: 0.9323674292515207
	Val rv:
		loss: 1.1651902198791504
		acc: 0.72425
Epochs without improvement: 3
Epoch 24 complete in 45.973464250564575 seconds
	Train rv:
		loss: 0.2063676118850708
		acc: 0.9323178391959799
	Val rv:
		loss: 1.0505094528198242
		acc: 0.713
Epochs without improvement: 4
Epoch 25 complete in 45.955811500549316 seconds
	Train rv:
		loss: 0.16709297895431519
		acc: 0.9420457550912457
	Val rv:
		loss: 1.1787625551223755
		acc: 0.7090000000000001
Epochs without improvement: 5
Epoch 26 complete in 46.01195502281189 seconds
	Train rv:
		loss: 0.18379664421081543
		acc: 0.9339377810103148
	Val rv:
		loss: 0.9541125297546387
		acc: 0.733625
New best model found.
Epoch 27 complete in 46.06213736534119 seconds
	Train rv:
		loss: 0.12911875545978546
		acc: 0.9545093890505157
	Val rv:
		loss: 1.258363127708435
		acc: 0.724375
Epochs without improvement: 1
Epoch 28 complete in 46.222182273864746 seconds
	Train rv:
		loss: 0.21966487169265747
		acc: 0.9285985850304153
	Val rv:
		loss: 1.265184998512268
		acc: 0.716125
Epochs without improvement: 2
Epoch 29 complete in 46.58691215515137 seconds
	Train rv:
		loss: 0.13164538145065308
		acc: 0.9557656704575509
	Val rv:
		loss: 1.2885193824768066
		acc: 0.711875
Epochs without improvement: 3
Epoch 30 complete in 46.28026533126831 seconds
	Train rv:
		loss: 0.1307784616947174
		acc: 0.9533605527638191
	Val rv:
		loss: 1.2051748037338257
		acc: 0.71025
Epochs without improvement: 4
Epoch 31 complete in 46.276615381240845 seconds
	Train rv:
		loss: 0.11233989894390106
		acc: 0.9631463237238825
	Val rv:
		loss: 1.1680458784103394
		acc: 0.7375
New best model found.
Epoch 32 complete in 45.93946957588196 seconds
	Train rv:
		loss: 0.10861948132514954
		acc: 0.9634108040201005
	Val rv:
		loss: 1.7144221067428589
		acc: 0.6745
Epochs without improvement: 1
Epoch 33 complete in 46.469584465026855 seconds
	Train rv:
		loss: 0.0943399965763092
		acc: 0.9682788944723618
	Val rv:
		loss: 1.3506217002868652
		acc: 0.716875
Epochs without improvement: 2
Epoch 34 complete in 46.14386177062988 seconds
	Train rv:
		loss: 0.11628084629774094
		acc: 0.962518183020365
	Val rv:
		loss: 1.3814711570739746
		acc: 0.72125
Epochs without improvement: 3
Epoch 35 complete in 45.859439849853516 seconds
	Train rv:
		loss: 0.09488729387521744
		acc: 0.9667581327691087
	Val rv:
		loss: 1.500105619430542
		acc: 0.674875
Epochs without improvement: 4
Epoch 36 complete in 45.84291982650757 seconds
	Train rv:
		loss: 0.09351450204849243
		acc: 0.9684772546945253
	Val rv:
		loss: 1.1403849124908447
		acc: 0.6927500000000001
Epochs without improvement: 5
Epoch 37 complete in 45.96814489364624 seconds
	Train rv:
		loss: 0.09529200196266174
		acc: 0.9654522613065326
	Val rv:
		loss: 1.6911853551864624
		acc: 0.7076250000000001
Epochs without improvement: 6
Epoch 38 complete in 45.93589115142822 seconds
	Train rv:
		loss: 0.06373775750398636
		acc: 0.9792713567839196
	Val rv:
		loss: 1.3165620565414429
		acc: 0.72075
Epochs without improvement: 7
Epoch 39 complete in 45.99047374725342 seconds
	Train rv:
		loss: 0.0784938633441925
		acc: 0.9766513488495107
	Val rv:
		loss: 1.428744912147522
		acc: 0.7191249999999999
Epochs without improvement: 8
Epoch 40 complete in 45.7249231338501 seconds
	Train rv:
		loss: 0.07116417586803436
		acc: 0.9767587939698492
	Val rv:
		loss: 1.4192904233932495
		acc: 0.72875
Epochs without improvement: 9
Epoch 41 complete in 45.99801325798035 seconds
	Train rv:
		loss: 0.062386054545640945
		acc: 0.9788002512562815
	Val rv:
		loss: 1.5540015697479248
		acc: 0.7042499999999999
Epochs without improvement: 10
Epoch 42 complete in 45.96808099746704 seconds
	Train rv:
		loss: 0.0841221958398819
		acc: 0.9713121528696113
	Val rv:
		loss: 1.389687180519104
		acc: 0.723875
Epochs without improvement: 11
Epoch 43 complete in 45.852701902389526 seconds
	Train rv:
		loss: 0.06456561386585236
		acc: 0.9801061227188574
	Val rv:
		loss: 1.3684965372085571
		acc: 0.7295
Epochs without improvement: 12
Epoch 44 complete in 45.92781090736389 seconds
	Train rv:
		loss: 0.08471817523241043
		acc: 0.9729899497487438
	Val rv:
		loss: 1.563075304031372
		acc: 0.7184999999999999
Epochs without improvement: 13
Epoch 45 complete in 46.098148345947266 seconds
	Train rv:
		loss: 0.06247655674815178
		acc: 0.9790068764877017
	Val rv:
		loss: 1.5011242628097534
		acc: 0.716
Epochs without improvement: 14
Epoch 46 complete in 45.870604276657104 seconds
	Train rv:
		loss: 0.07286213338375092
		acc: 0.9764447236180904
	Val rv:
		loss: 1.4075863361358643
		acc: 0.73125
Epochs without improvement: 15
Epoch 47 complete in 45.67128109931946 seconds
	Train rv:
		loss: 0.05744386836886406
		acc: 0.9830897910605659
	Val rv:
		loss: 1.4181599617004395
		acc: 0.7075
Epochs without improvement: 16
Epoch 48 complete in 45.67725849151611 seconds
	Train rv:
		loss: 0.047516319900751114
		acc: 0.9852882835228776
	Val rv:
		loss: 1.5814683437347412
		acc: 0.731
Epochs without improvement: 17
Epoch 49 complete in 45.89338254928589 seconds
	Train rv:
		loss: 0.07427094131708145
		acc: 0.9750314070351759
	Val rv:
		loss: 1.5787848234176636
		acc: 0.707375
Epochs without improvement: 18
Epoch 50 complete in 46.019286155700684 seconds
	Train rv:
		loss: 0.06344738602638245
		acc: 0.9797424623115578
	Val rv:
		loss: 1.6243269443511963
		acc: 0.6795
Epochs without improvement: 19
Epoch 51 complete in 46.13764429092407 seconds
	Train rv:
		loss: 0.053833965212106705
		acc: 0.9824120603015075
	Val rv:
		loss: 1.4792977571487427
		acc: 0.7325
Epochs without improvement: 20
Epoch 52 complete in 45.79121947288513 seconds
	Train rv:
		loss: 0.0426042303442955
		acc: 0.985966014281936
	Val rv:
		loss: 1.5431498289108276
		acc: 0.7447499999999999
New best model found.
Epoch 53 complete in 45.90011405944824 seconds
	Train rv:
		loss: 0.08607041090726852
		acc: 0.9733040201005025
	Val rv:
		loss: 1.2534046173095703
		acc: 0.728
Epochs without improvement: 1
Epoch 54 complete in 45.826372385025024 seconds
	Train rv:
		loss: 0.020113741979002953
		acc: 0.9935615577889447
	Val rv:
		loss: 2.001392126083374
		acc: 0.73125
Epochs without improvement: 2
Epoch 55 complete in 45.68151593208313 seconds
	Train rv:
		loss: 0.03612475097179413
		acc: 0.987751256281407
	Val rv:
		loss: 1.434181809425354
		acc: 0.716875
Epochs without improvement: 3
Epoch 56 complete in 45.82873892784119 seconds
	Train rv:
		loss: 0.08875884115695953
		acc: 0.9721469188045491
	Val rv:
		loss: 1.291846513748169
		acc: 0.7347499999999999
Epochs without improvement: 4
Epoch 57 complete in 45.66397309303284 seconds
	Train rv:
		loss: 0.044244185090065
		acc: 0.9864949748743719
	Val rv:
		loss: 1.4944032430648804
		acc: 0.7142499999999999
Epochs without improvement: 5
Epoch 58 complete in 45.86478638648987 seconds
	Train rv:
		loss: 0.07102943956851959
		acc: 0.9783291457286433
	Val rv:
		loss: 1.4161670207977295
		acc: 0.7176250000000001
Epochs without improvement: 6
Epoch 59 complete in 45.95414638519287 seconds
	Train rv:
		loss: 0.04532376304268837
		acc: 0.9851312483469982
	Val rv:
		loss: 1.5563113689422607
		acc: 0.72075
Epochs without improvement: 7
Epoch 60 complete in 45.69197416305542 seconds
	Train rv:
		loss: 0.06329073756933212
		acc: 0.9804201930706162
	Val rv:
		loss: 1.3445199728012085
		acc: 0.710625
Epochs without improvement: 8
Epoch 61 complete in 45.627164125442505 seconds
	Train rv:
		loss: 0.05374477058649063
		acc: 0.9841394472361809
	Val rv:
		loss: 1.426458477973938
		acc: 0.7241249999999999
Epochs without improvement: 9
Epoch 62 complete in 45.694692850112915 seconds
	Train rv:
		loss: 0.03366171196103096
		acc: 0.9902638190954773
	Val rv:
		loss: 1.7841871976852417
		acc: 0.7096250000000001
Epochs without improvement: 10
Epoch 63 complete in 45.98892068862915 seconds
	Train rv:
		loss: 0.06913921236991882
		acc: 0.9783291457286433
	Val rv:
		loss: 1.6578782796859741
		acc: 0.702375
Epochs without improvement: 11
Epoch 64 complete in 45.71733069419861 seconds
	Train rv:
		loss: 0.04348547011613846
		acc: 0.9874371859296482
	Val rv:
		loss: 1.7812260389328003
		acc: 0.6934999999999999
Epochs without improvement: 12
Epoch 65 complete in 45.789660692214966 seconds
	Train rv:
		loss: 0.062035948038101196
		acc: 0.9819905448294102
	Val rv:
		loss: 1.6289951801300049
		acc: 0.7015
Epochs without improvement: 13
Epoch 66 complete in 46.130513429641724 seconds
	Train rv:
		loss: 0.04608722776174545
		acc: 0.985445318698757
	Val rv:
		loss: 1.6476436853408813
		acc: 0.71025
Epochs without improvement: 14
Epoch 67 complete in 46.03010630607605 seconds
	Train rv:
		loss: 0.028160540387034416
		acc: 0.9921482412060302
	Val rv:
		loss: 1.460158348083496
		acc: 0.722125
Epochs without improvement: 15
Epoch 68 complete in 45.82099223136902 seconds
	Train rv:
		loss: 0.048432786017656326
		acc: 0.9830402010050251
	Val rv:
		loss: 1.3665742874145508
		acc: 0.699125
Epochs without improvement: 16
Epoch 69 complete in 46.11486268043518 seconds
	Train rv:
		loss: 0.03319371119141579
		acc: 0.9890075376884422
	Val rv:
		loss: 1.6828535795211792
		acc: 0.710625
Epochs without improvement: 17
Epoch 70 complete in 45.820754528045654 seconds
	Train rv:
		loss: 0.050702761858701706
		acc: 0.9829327558846865
	Val rv:
		loss: 1.3156177997589111
		acc: 0.71125
Epochs without improvement: 18
Epoch 71 complete in 46.14766597747803 seconds
	Train rv:
		loss: 0.05350099503993988
		acc: 0.9822550251256281
	Val rv:
		loss: 1.8137723207473755
		acc: 0.6913750000000001
Epochs without improvement: 19
Epoch 72 complete in 45.77832055091858 seconds
	Train rv:
		loss: 0.055017147213220596
		acc: 0.981254959005554
	Val rv:
		loss: 1.571961522102356
		acc: 0.709375
Epochs without improvement: 20
Epoch 73 complete in 46.1703724861145 seconds
	Train rv:
		loss: 0.045019399374723434
		acc: 0.9868090452261307
	Val rv:
		loss: 1.4139496088027954
		acc: 0.731125
Epochs without improvement: 21
Epoch 74 complete in 45.74118733406067 seconds
	Train rv:
		loss: 0.0370003767311573
		acc: 0.9891645728643216
	Val rv:
		loss: 1.679002046585083
		acc: 0.6920000000000001
Epochs without improvement: 22
Epoch 75 complete in 45.834813594818115 seconds
	Train rv:
		loss: 0.035745102912187576
		acc: 0.9891645728643216
	Val rv:
		loss: 1.674964189529419
		acc: 0.7125
Epochs without improvement: 23
Epoch 76 complete in 45.929513931274414 seconds
	Train rv:
		loss: 0.02682528644800186
		acc: 0.9926193467336684
	Val rv:
		loss: 1.7737069129943848
		acc: 0.727375
Epochs without improvement: 24
Epoch 77 complete in 46.33509063720703 seconds
	Train rv:
		loss: 0.07758790999650955
		acc: 0.9744528563871991
	Val rv:
		loss: 1.4805625677108765
		acc: 0.722375
Epochs without improvement: 25
Epoch 78 complete in 45.977928161621094 seconds
	Train rv:
		loss: 0.012219445779919624
		acc: 0.9967022613065326
	Val rv:
		loss: 1.7382500171661377
		acc: 0.7440000000000001
Epochs without improvement: 26
Epoch 79 complete in 46.30214285850525 seconds
	Train rv:
		loss: 0.0007907743565738201
		acc: 1.0
	Val rv:
		loss: 1.842734932899475
		acc: 0.738
Epochs without improvement: 27
Epoch 80 complete in 46.118258476257324 seconds
	Train rv:
		loss: 0.00020979972032364458
		acc: 1.0
	Val rv:
		loss: 1.806572437286377
		acc: 0.743375
Epochs without improvement: 28
Epoch 81 complete in 46.15861368179321 seconds
	Train rv:
		loss: 0.00017207935161422938
		acc: 1.0
	Val rv:
		loss: 1.796961784362793
		acc: 0.743375
Epochs without improvement: 29
Epoch 82 complete in 45.85544681549072 seconds
	Train rv:
		loss: 0.00018745310080703348
		acc: 1.0
	Val rv:
		loss: 1.7955952882766724
		acc: 0.7408750000000001
Epochs without improvement: 30
Epoch 83 complete in 46.172741413116455 seconds
	Train rv:
		loss: 0.00021139971795491874
		acc: 1.0
	Val rv:
		loss: 1.7860286235809326
		acc: 0.7440000000000001
Epochs without improvement: 31
Epoch 84 complete in 46.20584297180176 seconds
	Train rv:
		loss: 0.00022432587866205722
		acc: 1.0
	Val rv:
		loss: 1.80621337890625
		acc: 0.7408750000000001
Epochs without improvement: 32
Epoch 85 complete in 46.21982765197754 seconds
	Train rv:
		loss: 0.0002468806051183492
		acc: 1.0
	Val rv:
		loss: 1.821608543395996
		acc: 0.7402500000000001
Epochs without improvement: 33
Epoch 86 complete in 46.20651912689209 seconds
	Train rv:
		loss: 0.0003254122566431761
		acc: 1.0
	Val rv:
		loss: 1.8354732990264893
		acc: 0.742125
Epochs without improvement: 34
Epoch 87 complete in 45.9790313243866 seconds
	Train rv:
		loss: 0.00034930737456306815
		acc: 1.0
	Val rv:
		loss: 1.9016427993774414
		acc: 0.738375
Epochs without improvement: 35
Epoch 88 complete in 45.89559531211853 seconds
	Train rv:
		loss: 0.21739710867404938
		acc: 0.9320533588997619
	Val rv:
		loss: 0.8819061517715454
		acc: 0.7021250000000001
Epochs without improvement: 36
Epoch 89 complete in 45.57224249839783 seconds
	Train rv:
		loss: 0.23364785313606262
		acc: 0.9207468262364453
	Val rv:
		loss: 0.9705207943916321
		acc: 0.7245
Epochs without improvement: 37
Epoch 90 complete in 45.62612199783325 seconds
	Train rv:
		loss: 0.1044980138540268
		acc: 0.9664936524728908
	Val rv:
		loss: 1.2161697149276733
		acc: 0.725625
Epochs without improvement: 38
Epoch 91 complete in 45.710586071014404 seconds
	Train rv:
		loss: 0.056079719215631485
		acc: 0.9808417085427136
	Val rv:
		loss: 1.3387882709503174
		acc: 0.74125
Epochs without improvement: 39
Epoch 92 complete in 45.688517332077026 seconds
	Train rv:
		loss: 0.0718313604593277
		acc: 0.977072864321608
	Val rv:
		loss: 1.3048133850097656
		acc: 0.71375
Epochs without improvement: 40
Epoch 93 complete in 45.85783910751343 seconds
	Train rv:
		loss: 0.030944522470235825
		acc: 0.9902638190954773
	Val rv:
		loss: 1.4642623662948608
		acc: 0.7196250000000001
Epochs without improvement: 41
Epoch 94 complete in 46.25763511657715 seconds
	Train rv:
		loss: 0.06944576650857925
		acc: 0.9775439698492462
	Val rv:
		loss: 1.600295066833496
		acc: 0.722125
Epochs without improvement: 42
Epoch 95 complete in 45.593427896499634 seconds
	Train rv:
		loss: 0.05826937034726143
		acc: 0.9827261306532663
	Val rv:
		loss: 1.4158841371536255
		acc: 0.706875
Epochs without improvement: 43
Epoch 96 complete in 45.67425012588501 seconds
	Train rv:
		loss: 0.007117619272321463
		acc: 0.9985866834170855
	Val rv:
		loss: 1.7559738159179688
		acc: 0.7275
Epochs without improvement: 44
Epoch 97 complete in 46.31682372093201 seconds
	Train rv:
		loss: 0.0011301616905257106
		acc: 0.9996859296482412
	Val rv:
		loss: 1.9064918756484985
		acc: 0.72875
Epochs without improvement: 45
Epoch 98 complete in 46.031994104385376 seconds
	Train rv:
		loss: 0.0005225064815022051
		acc: 1.0
	Val rv:
		loss: 1.796169400215149
		acc: 0.740625
Epochs without improvement: 46
Epoch 99 complete in 46.40912079811096 seconds
	Train rv:
		loss: 0.00018758836085908115
		acc: 1.0
	Val rv:
		loss: 1.8018295764923096
		acc: 0.74375
Epochs without improvement: 47
Epoch 100 complete in 46.06665635108948 seconds
	Train rv:
		loss: 0.00017973975627683103
		acc: 1.0
	Val rv:
		loss: 1.8109571933746338
		acc: 0.738125
Epochs without improvement: 48
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.PACS'> with domain cartoon held out.
Training a feature extractor.
Save dir: ./results/PACS/omit_cartoon/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.PACS'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['art_painting', 'photo', 'sketch'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 44.53278946876526 seconds
	Train rv:
		loss: 2.46913743019104
		acc: 0.20529513888888887
	Val rv:
		loss: 1.79425847530365
		acc: 0.21510416666666665
New best model found.
Epoch 2 complete in 44.52968978881836 seconds
	Train rv:
		loss: 1.700231909751892
		acc: 0.2921549479166667
	Val rv:
		loss: 1.6042808294296265
		acc: 0.31518229166666667
New best model found.
Epoch 3 complete in 44.54495143890381 seconds
	Train rv:
		loss: 1.558335304260254
		acc: 0.3586697048611111
	Val rv:
		loss: 1.4864511489868164
		acc: 0.3857552083333333
New best model found.
Epoch 4 complete in 44.26642322540283 seconds
	Train rv:
		loss: 1.447778582572937
		acc: 0.41216362847222227
	Val rv:
		loss: 1.3974229097366333
		acc: 0.4422916666666667
New best model found.
Epoch 5 complete in 44.38768672943115 seconds
	Train rv:
		loss: 1.3740296363830566
		acc: 0.451171875
	Val rv:
		loss: 1.3227458000183105
		acc: 0.4891666666666667
New best model found.
Epoch 6 complete in 44.1634681224823 seconds
	Train rv:
		loss: 1.2725974321365356
		acc: 0.5027669270833334
	Val rv:
		loss: 1.2433613538742065
		acc: 0.5047916666666666
New best model found.
Epoch 7 complete in 44.11382603645325 seconds
	Train rv:
		loss: 1.1769005060195923
		acc: 0.539767795138889
	Val rv:
		loss: 1.0955036878585815
		acc: 0.5635677083333334
New best model found.
Epoch 8 complete in 44.24130964279175 seconds
	Train rv:
		loss: 1.081947684288025
		acc: 0.5796983506944444
	Val rv:
		loss: 0.999897301197052
		acc: 0.6339583333333333
New best model found.
Epoch 9 complete in 44.22278141975403 seconds
	Train rv:
		loss: 1.0356245040893555
		acc: 0.6021592881944444
	Val rv:
		loss: 1.0361833572387695
		acc: 0.6086718750000001
Epochs without improvement: 1
Epoch 10 complete in 44.43663716316223 seconds
	Train rv:
		loss: 0.9937970638275146
		acc: 0.621310763888889
	Val rv:
		loss: 0.9768390655517578
		acc: 0.6305208333333333
Epochs without improvement: 2
Epoch 11 complete in 44.48891639709473 seconds
	Train rv:
		loss: 0.8932881355285645
		acc: 0.6602647569444444
	Val rv:
		loss: 1.0841313600540161
		acc: 0.5976041666666667
Epochs without improvement: 3
Epoch 12 complete in 44.75648903846741 seconds
	Train rv:
		loss: 0.8644251823425293
		acc: 0.6781684027777778
	Val rv:
		loss: 0.9280926585197449
		acc: 0.6550781250000001
New best model found.
Epoch 13 complete in 44.20825958251953 seconds
	Train rv:
		loss: 0.7670941352844238
		acc: 0.7130533854166666
	Val rv:
		loss: 0.9694867730140686
		acc: 0.6314583333333333
Epochs without improvement: 1
Epoch 14 complete in 44.640071392059326 seconds
	Train rv:
		loss: 0.7389737963676453
		acc: 0.7278645833333334
	Val rv:
		loss: 0.9548946022987366
		acc: 0.6474479166666667
Epochs without improvement: 2
Epoch 15 complete in 44.24855899810791 seconds
	Train rv:
		loss: 0.6712942123413086
		acc: 0.7487521701388888
	Val rv:
		loss: 1.084479808807373
		acc: 0.6358333333333334
Epochs without improvement: 3
Epoch 16 complete in 44.19748306274414 seconds
	Train rv:
		loss: 0.6373270153999329
		acc: 0.76220703125
	Val rv:
		loss: 1.0462223291397095
		acc: 0.6591666666666667
New best model found.
Epoch 17 complete in 44.30707335472107 seconds
	Train rv:
		loss: 0.5667481422424316
		acc: 0.7932942708333334
	Val rv:
		loss: 1.0701937675476074
		acc: 0.6578645833333333
Epochs without improvement: 1
Epoch 18 complete in 44.669950008392334 seconds
	Train rv:
		loss: 0.52300626039505
		acc: 0.8092447916666666
	Val rv:
		loss: 0.9942538142204285
		acc: 0.6475520833333334
Epochs without improvement: 2
Epoch 19 complete in 44.14236545562744 seconds
	Train rv:
		loss: 0.5047956109046936
		acc: 0.8182508680555555
	Val rv:
		loss: 1.0660325288772583
		acc: 0.6241145833333334
Epochs without improvement: 3
Epoch 20 complete in 44.522770166397095 seconds
	Train rv:
		loss: 0.4361933171749115
		acc: 0.8451605902777778
	Val rv:
		loss: 1.0620787143707275
		acc: 0.6561979166666667
Epochs without improvement: 4
Epoch 21 complete in 44.30076789855957 seconds
	Train rv:
		loss: 0.36221957206726074
		acc: 0.8699001736111112
	Val rv:
		loss: 1.2610574960708618
		acc: 0.6485677083333333
Epochs without improvement: 5
Epoch 22 complete in 44.36619687080383 seconds
	Train rv:
		loss: 0.32992181181907654
		acc: 0.8801540798611112
	Val rv:
		loss: 1.7247458696365356
		acc: 0.620859375
Epochs without improvement: 6
Epoch 23 complete in 44.196489334106445 seconds
	Train rv:
		loss: 0.3063019812107086
		acc: 0.892578125
	Val rv:
		loss: 1.3686904907226562
		acc: 0.652109375
Epochs without improvement: 7
Epoch 24 complete in 44.389440059661865 seconds
	Train rv:
		loss: 0.2832280397415161
		acc: 0.8992513020833334
	Val rv:
		loss: 1.4597467184066772
		acc: 0.6500520833333333
Epochs without improvement: 8
Epoch 25 complete in 44.200478315353394 seconds
	Train rv:
		loss: 0.23589229583740234
		acc: 0.9146592881944445
	Val rv:
		loss: 1.3554147481918335
		acc: 0.6515364583333333
Epochs without improvement: 9
Epoch 26 complete in 44.379420042037964 seconds
	Train rv:
		loss: 0.258568674325943
		acc: 0.90966796875
	Val rv:
		loss: 1.3259145021438599
		acc: 0.6711718750000001
New best model found.
Epoch 27 complete in 44.55006814002991 seconds
	Train rv:
		loss: 0.16993892192840576
		acc: 0.9400499131944445
	Val rv:
		loss: 1.5745378732681274
		acc: 0.6695833333333333
Epochs without improvement: 1
Epoch 28 complete in 44.28835439682007 seconds
	Train rv:
		loss: 0.1813298463821411
		acc: 0.9404296875
	Val rv:
		loss: 1.6998568773269653
		acc: 0.6511718750000001
Epochs without improvement: 2
Epoch 29 complete in 44.40958213806152 seconds
	Train rv:
		loss: 0.15106411278247833
		acc: 0.9466145833333334
	Val rv:
		loss: 1.8989591598510742
		acc: 0.6550781250000001
Epochs without improvement: 3
Epoch 30 complete in 44.51100492477417 seconds
	Train rv:
		loss: 0.13583455979824066
		acc: 0.9537760416666666
	Val rv:
		loss: 1.6102529764175415
		acc: 0.6540625
Epochs without improvement: 4
Epoch 31 complete in 44.65063548088074 seconds
	Train rv:
		loss: 0.11857219785451889
		acc: 0.9591471354166666
	Val rv:
		loss: 1.7999897003173828
		acc: 0.6347135416666667
Epochs without improvement: 5
Epoch 32 complete in 44.346855878829956 seconds
	Train rv:
		loss: 0.14265872538089752
		acc: 0.9503038194444445
	Val rv:
		loss: 1.7410780191421509
		acc: 0.6405729166666667
Epochs without improvement: 6
Epoch 33 complete in 44.33611750602722 seconds
	Train rv:
		loss: 0.11683271080255508
		acc: 0.95849609375
	Val rv:
		loss: 2.1332437992095947
		acc: 0.6485677083333333
Epochs without improvement: 7
Epoch 34 complete in 44.13967704772949 seconds
	Train rv:
		loss: 0.1175617054104805
		acc: 0.9593098958333334
	Val rv:
		loss: 1.827012062072754
		acc: 0.6547916666666667
Epochs without improvement: 8
Epoch 35 complete in 44.32392144203186 seconds
	Train rv:
		loss: 0.09567544609308243
		acc: 0.9679361979166666
	Val rv:
		loss: 1.9437246322631836
		acc: 0.64046875
Epochs without improvement: 9
Epoch 36 complete in 44.77648997306824 seconds
	Train rv:
		loss: 0.07996086031198502
		acc: 0.97314453125
	Val rv:
		loss: 1.958706259727478
		acc: 0.6531250000000001
Epochs without improvement: 10
Epoch 37 complete in 44.26935935020447 seconds
	Train rv:
		loss: 0.10507025569677353
		acc: 0.96728515625
	Val rv:
		loss: 1.9178284406661987
		acc: 0.642890625
Epochs without improvement: 11
Epoch 38 complete in 44.47110199928284 seconds
	Train rv:
		loss: 0.09552562236785889
		acc: 0.9656032986111112
	Val rv:
		loss: 1.9636491537094116
		acc: 0.6264322916666667
Epochs without improvement: 12
Epoch 39 complete in 44.55212354660034 seconds
	Train rv:
		loss: 0.12301834672689438
		acc: 0.9586588541666666
	Val rv:
		loss: 1.5626792907714844
		acc: 0.6552604166666667
Epochs without improvement: 13
Epoch 40 complete in 44.1656973361969 seconds
	Train rv:
		loss: 0.07872773706912994
		acc: 0.9696180555555555
	Val rv:
		loss: 2.2973639965057373
		acc: 0.6421614583333334
Epochs without improvement: 14
Epoch 41 complete in 44.02782106399536 seconds
	Train rv:
		loss: 0.15331687033176422
		acc: 0.9475911458333334
	Val rv:
		loss: 1.889428734779358
		acc: 0.6288541666666667
Epochs without improvement: 15
Epoch 42 complete in 44.58408284187317 seconds
	Train rv:
		loss: 0.04999849200248718
		acc: 0.9835611979166666
	Val rv:
		loss: 1.9104241132736206
		acc: 0.6627083333333333
Epochs without improvement: 16
Epoch 43 complete in 44.01571774482727 seconds
	Train rv:
		loss: 0.03348470851778984
		acc: 0.9892578125
	Val rv:
		loss: 1.8415216207504272
		acc: 0.66046875
Epochs without improvement: 17
Epoch 44 complete in 44.10553598403931 seconds
	Train rv:
		loss: 0.0856766626238823
		acc: 0.9724934895833334
	Val rv:
		loss: 2.078334093093872
		acc: 0.6511718750000001
Epochs without improvement: 18
Epoch 45 complete in 44.27401089668274 seconds
	Train rv:
		loss: 0.0913671925663948
		acc: 0.96826171875
	Val rv:
		loss: 1.7222051620483398
		acc: 0.6588020833333333
Epochs without improvement: 19
Epoch 46 complete in 44.63569736480713 seconds
	Train rv:
		loss: 0.060737963765859604
		acc: 0.9793294270833334
	Val rv:
		loss: 1.98446524143219
		acc: 0.6102604166666666
Epochs without improvement: 20
Epoch 47 complete in 44.33300423622131 seconds
	Train rv:
		loss: 0.08563794940710068
		acc: 0.970703125
	Val rv:
		loss: 1.9961892366409302
		acc: 0.6598177083333333
Epochs without improvement: 21
Epoch 48 complete in 44.05764937400818 seconds
	Train rv:
		loss: 0.06535070389509201
		acc: 0.97900390625
	Val rv:
		loss: 2.13847279548645
		acc: 0.6360156250000001
Epochs without improvement: 22
Epoch 49 complete in 44.28653645515442 seconds
	Train rv:
		loss: 0.10998686403036118
		acc: 0.96337890625
	Val rv:
		loss: 1.8156601190567017
		acc: 0.64625
Epochs without improvement: 23
Epoch 50 complete in 44.61906337738037 seconds
	Train rv:
		loss: 0.036222901195287704
		acc: 0.9894205729166666
	Val rv:
		loss: 2.118680953979492
		acc: 0.6390885416666666
Epochs without improvement: 24
Epoch 51 complete in 44.78454351425171 seconds
	Train rv:
		loss: 0.03863133117556572
		acc: 0.98828125
	Val rv:
		loss: 2.012485980987549
		acc: 0.6666145833333333
Epochs without improvement: 25
Epoch 52 complete in 44.20545482635498 seconds
	Train rv:
		loss: 0.052464861422777176
		acc: 0.98388671875
	Val rv:
		loss: 2.067903518676758
		acc: 0.6461458333333333
Epochs without improvement: 26
Epoch 53 complete in 44.170536041259766 seconds
	Train rv:
		loss: 0.09203249216079712
		acc: 0.9676106770833334
	Val rv:
		loss: 2.202197551727295
		acc: 0.638984375
Epochs without improvement: 27
Epoch 54 complete in 44.311601877212524 seconds
	Train rv:
		loss: 0.06914359331130981
		acc: 0.9771592881944445
	Val rv:
		loss: 2.4300084114074707
		acc: 0.6023437500000001
Epochs without improvement: 28
Epoch 55 complete in 44.34597611427307 seconds
	Train rv:
		loss: 0.10538627952337265
		acc: 0.9654947916666666
	Val rv:
		loss: 2.143911123275757
		acc: 0.6547135416666666
Epochs without improvement: 29
Epoch 56 complete in 44.04920673370361 seconds
	Train rv:
		loss: 0.054672230035066605
		acc: 0.9803059895833334
	Val rv:
		loss: 2.0927515029907227
		acc: 0.6431770833333333
Epochs without improvement: 30
Epoch 57 complete in 44.2071533203125 seconds
	Train rv:
		loss: 0.044216323643922806
		acc: 0.9869791666666666
	Val rv:
		loss: 1.8120126724243164
		acc: 0.6606510416666667
Epochs without improvement: 31
Epoch 58 complete in 44.443371057510376 seconds
	Train rv:
		loss: 0.07320841401815414
		acc: 0.9763454861111112
	Val rv:
		loss: 1.7117999792099
		acc: 0.6182552083333334
Epochs without improvement: 32
Epoch 59 complete in 44.017271995544434 seconds
	Train rv:
		loss: 0.03826778754591942
		acc: 0.98876953125
	Val rv:
		loss: 2.0750505924224854
		acc: 0.658515625
Epochs without improvement: 33
Epoch 60 complete in 44.127880573272705 seconds
	Train rv:
		loss: 0.051343049854040146
		acc: 0.9820963541666666
	Val rv:
		loss: 2.05313777923584
		acc: 0.6581510416666667
Epochs without improvement: 34
Epoch 61 complete in 44.370229721069336 seconds
	Train rv:
		loss: 0.07652969658374786
		acc: 0.9744466145833334
	Val rv:
		loss: 1.8357563018798828
		acc: 0.6509895833333333
Epochs without improvement: 35
Epoch 62 complete in 44.17796301841736 seconds
	Train rv:
		loss: 0.06770312041044235
		acc: 0.9773763020833334
	Val rv:
		loss: 1.720054268836975
		acc: 0.6321093750000001
Epochs without improvement: 36
Epoch 63 complete in 44.26192331314087 seconds
	Train rv:
		loss: 0.06720351427793503
		acc: 0.9773763020833334
	Val rv:
		loss: 2.2684316635131836
		acc: 0.6348958333333333
Epochs without improvement: 37
Epoch 64 complete in 44.14071607589722 seconds
	Train rv:
		loss: 0.03580983355641365
		acc: 0.98974609375
	Val rv:
		loss: 1.9273658990859985
		acc: 0.6455989583333334
Epochs without improvement: 38
Epoch 65 complete in 44.05172514915466 seconds
	Train rv:
		loss: 0.07181286811828613
		acc: 0.974609375
	Val rv:
		loss: 1.8977006673812866
		acc: 0.661953125
Epochs without improvement: 39
Epoch 66 complete in 44.21453404426575 seconds
	Train rv:
		loss: 0.03726651147007942
		acc: 0.9871419270833334
	Val rv:
		loss: 2.3160560131073
		acc: 0.6477343750000001
Epochs without improvement: 40
Epoch 67 complete in 44.038267374038696 seconds
	Train rv:
		loss: 0.028691530227661133
		acc: 0.9912109375
	Val rv:
		loss: 2.3841304779052734
		acc: 0.654609375
Epochs without improvement: 41
Epoch 68 complete in 44.089792013168335 seconds
	Train rv:
		loss: 0.0613425076007843
		acc: 0.9796549479166666
	Val rv:
		loss: 2.264176607131958
		acc: 0.6496875000000001
Epochs without improvement: 42
Epoch 69 complete in 44.36710023880005 seconds
	Train rv:
		loss: 0.06857257336378098
		acc: 0.9781901041666666
	Val rv:
		loss: 2.1950457096099854
		acc: 0.6290364583333333
Epochs without improvement: 43
Epoch 70 complete in 44.53725814819336 seconds
	Train rv:
		loss: 0.01923452876508236
		acc: 0.9939778645833334
	Val rv:
		loss: 2.5359320640563965
		acc: 0.6381510416666667
Epochs without improvement: 44
Epoch 71 complete in 44.15750694274902 seconds
	Train rv:
		loss: 0.06386058777570724
		acc: 0.9791666666666666
	Val rv:
		loss: 1.973902702331543
		acc: 0.6477343750000001
Epochs without improvement: 45
Epoch 72 complete in 44.152604818344116 seconds
	Train rv:
		loss: 0.050641197711229324
		acc: 0.9844835069444445
	Val rv:
		loss: 2.4281837940216064
		acc: 0.6342447916666667
Epochs without improvement: 46
Epoch 73 complete in 44.370400190353394 seconds
	Train rv:
		loss: 0.06933572888374329
		acc: 0.9765625
	Val rv:
		loss: 2.129009246826172
		acc: 0.6441145833333334
Epochs without improvement: 47
Epoch 74 complete in 44.47787880897522 seconds
	Train rv:
		loss: 0.02299702726304531
		acc: 0.9938151041666666
	Val rv:
		loss: 2.1567656993865967
		acc: 0.6375000000000001
Epochs without improvement: 48
Epoch 75 complete in 44.34280467033386 seconds
	Train rv:
		loss: 0.06272248178720474
		acc: 0.97705078125
	Val rv:
		loss: 2.065035820007324
		acc: 0.6537760416666667
Epochs without improvement: 49
Epoch 76 complete in 44.315160036087036 seconds
	Train rv:
		loss: 0.05666181072592735
		acc: 0.9812825520833334
	Val rv:
		loss: 1.9789501428604126
		acc: 0.6280208333333334
Epochs without improvement: 50
Epoch 77 complete in 44.05796265602112 seconds
	Train rv:
		loss: 0.043653860688209534
		acc: 0.9861111111111112
	Val rv:
		loss: 2.3129985332489014
		acc: 0.6470833333333333
Epochs without improvement: 51
Epoch 78 complete in 44.446786403656006 seconds
	Train rv:
		loss: 0.03834984824061394
		acc: 0.98681640625
	Val rv:
		loss: 2.7144391536712646
		acc: 0.6293229166666666
Epochs without improvement: 52
Epoch 79 complete in 44.40446615219116 seconds
	Train rv:
		loss: 0.04769033566117287
		acc: 0.9844835069444445
	Val rv:
		loss: 2.350775957107544
		acc: 0.6400260416666667
Epochs without improvement: 53
Epoch 80 complete in 44.54509902000427 seconds
	Train rv:
		loss: 0.08157213777303696
		acc: 0.9759114583333334
	Val rv:
		loss: 2.081986665725708
		acc: 0.6444791666666667
Epochs without improvement: 54
Epoch 81 complete in 44.320234060287476 seconds
	Train rv:
		loss: 0.022298069670796394
		acc: 0.9938151041666666
	Val rv:
		loss: 2.0270180702209473
		acc: 0.6667968750000001
Epochs without improvement: 55
Epoch 82 complete in 44.54874515533447 seconds
	Train rv:
		loss: 0.04359452798962593
		acc: 0.9871419270833334
	Val rv:
		loss: 1.9907499551773071
		acc: 0.6396354166666667
Epochs without improvement: 56
Epoch 83 complete in 44.118696451187134 seconds
	Train rv:
		loss: 0.03788653388619423
		acc: 0.98779296875
	Val rv:
		loss: 2.8512191772460938
		acc: 0.5942708333333333
Epochs without improvement: 57
Epoch 84 complete in 44.07589554786682 seconds
	Train rv:
		loss: 0.07042957097291946
		acc: 0.9786783854166666
	Val rv:
		loss: 1.8809500932693481
		acc: 0.6392708333333333
Epochs without improvement: 58
Epoch 85 complete in 44.15178036689758 seconds
	Train rv:
		loss: 0.025417864322662354
		acc: 0.9920247395833334
	Val rv:
		loss: 2.6507270336151123
		acc: 0.6106250000000001
Epochs without improvement: 59
Epoch 86 complete in 44.00506782531738 seconds
	Train rv:
		loss: 0.05047294497489929
		acc: 0.9845377604166666
	Val rv:
		loss: 2.158708333969116
		acc: 0.6427083333333333
Epochs without improvement: 60
Epoch 87 complete in 44.171056270599365 seconds
	Train rv:
		loss: 0.02535909228026867
		acc: 0.9925130208333334
	Val rv:
		loss: 2.2652952671051025
		acc: 0.6530468749999999
Epochs without improvement: 61
Epoch 88 complete in 44.241774797439575 seconds
	Train rv:
		loss: 0.02171984873712063
		acc: 0.9925130208333334
	Val rv:
		loss: 2.038908004760742
		acc: 0.6559114583333333
Epochs without improvement: 62
Epoch 89 complete in 44.07157897949219 seconds
	Train rv:
		loss: 0.03363049775362015
		acc: 0.9890950520833334
	Val rv:
		loss: 2.2615811824798584
		acc: 0.6381510416666667
Epochs without improvement: 63
Epoch 90 complete in 44.19613075256348 seconds
	Train rv:
		loss: 0.08294962346553802
		acc: 0.97216796875
	Val rv:
		loss: 2.195462226867676
		acc: 0.6379687500000001
Epochs without improvement: 64
Epoch 91 complete in 44.11597299575806 seconds
	Train rv:
		loss: 0.02186821959912777
		acc: 0.9939778645833334
	Val rv:
		loss: 2.101112127304077
		acc: 0.6420572916666667
Epochs without improvement: 65
Epoch 92 complete in 44.34056568145752 seconds
	Train rv:
		loss: 0.008804219774901867
		acc: 0.9970703125
	Val rv:
		loss: 2.4530203342437744
		acc: 0.6381510416666667
Epochs without improvement: 66
Epoch 93 complete in 44.28035354614258 seconds
	Train rv:
		loss: 0.04528803005814552
		acc: 0.98388671875
	Val rv:
		loss: 1.8967266082763672
		acc: 0.6515364583333333
Epochs without improvement: 67
Epoch 94 complete in 44.631842851638794 seconds
	Train rv:
		loss: 0.052346955984830856
		acc: 0.982421875
	Val rv:
		loss: 2.240427017211914
		acc: 0.6383333333333333
Epochs without improvement: 68
Epoch 95 complete in 44.31917405128479 seconds
	Train rv:
		loss: 0.0403548888862133
		acc: 0.9861653645833334
	Val rv:
		loss: 2.0944135189056396
		acc: 0.6676302083333333
Epochs without improvement: 69
Epoch 96 complete in 44.24509525299072 seconds
	Train rv:
		loss: 0.04305647313594818
		acc: 0.9864908854166666
	Val rv:
		loss: 1.8331599235534668
		acc: 0.6609375000000001
Epochs without improvement: 70
Epoch 97 complete in 43.99076247215271 seconds
	Train rv:
		loss: 0.027700131759047508
		acc: 0.9913736979166666
	Val rv:
		loss: 2.0392141342163086
		acc: 0.650234375
Epochs without improvement: 71
Epoch 98 complete in 44.23115515708923 seconds
	Train rv:
		loss: 0.06622175127267838
		acc: 0.97705078125
	Val rv:
		loss: 2.3920021057128906
		acc: 0.6368489583333333
Epochs without improvement: 72
Epoch 99 complete in 44.30660533905029 seconds
	Train rv:
		loss: 0.023661786690354347
		acc: 0.9930013020833334
	Val rv:
		loss: 2.164398431777954
		acc: 0.6322916666666667
Epochs without improvement: 73
Epoch 100 complete in 44.454760789871216 seconds
	Train rv:
		loss: 0.057610224932432175
		acc: 0.9817708333333334
	Val rv:
		loss: 1.8494313955307007
		acc: 0.6377864583333334
Epochs without improvement: 74
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.PACS'> with domain photo held out.
Training a feature extractor.
Save dir: ./results/PACS/omit_photo/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.PACS'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['art_painting', 'cartoon', 'sketch'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 47.98259139060974 seconds
	Train rv:
		loss: 2.375403881072998
		acc: 0.2444677033492823
	Val rv:
		loss: 1.84523606300354
		acc: 0.24579326923076922
New best model found.
Epoch 2 complete in 48.14049792289734 seconds
	Train rv:
		loss: 1.7886638641357422
		acc: 0.2619617224880383
	Val rv:
		loss: 1.6983888149261475
		acc: 0.34915865384615385
New best model found.
Epoch 3 complete in 48.01638460159302 seconds
	Train rv:
		loss: 1.5709278583526611
		acc: 0.38427033492822965
	Val rv:
		loss: 1.6361719369888306
		acc: 0.3485576923076923
Epochs without improvement: 1
Epoch 4 complete in 48.137157917022705 seconds
	Train rv:
		loss: 1.407212734222412
		acc: 0.45215311004784686
	Val rv:
		loss: 1.3609466552734375
		acc: 0.4855769230769231
New best model found.
Epoch 5 complete in 48.10015654563904 seconds
	Train rv:
		loss: 1.3335644006729126
		acc: 0.48504784688995217
	Val rv:
		loss: 1.3822568655014038
		acc: 0.45552884615384615
Epochs without improvement: 1
Epoch 6 complete in 48.21696853637695 seconds
	Train rv:
		loss: 1.2463628053665161
		acc: 0.5313995215311005
	Val rv:
		loss: 1.286173701286316
		acc: 0.5132211538461539
New best model found.
Epoch 7 complete in 48.1729998588562 seconds
	Train rv:
		loss: 1.134276270866394
		acc: 0.5747607655502392
	Val rv:
		loss: 1.1962592601776123
		acc: 0.5558894230769231
New best model found.
Epoch 8 complete in 48.08683466911316 seconds
	Train rv:
		loss: 1.0899277925491333
		acc: 0.5883672248803827
	Val rv:
		loss: 1.3411705493927002
		acc: 0.484375
Epochs without improvement: 1
Epoch 9 complete in 48.4089994430542 seconds
	Train rv:
		loss: 1.025663137435913
		acc: 0.6188696172248804
	Val rv:
		loss: 1.1663075685501099
		acc: 0.5594951923076923
New best model found.
Epoch 10 complete in 48.188387632369995 seconds
	Train rv:
		loss: 0.947939932346344
		acc: 0.64997009569378
	Val rv:
		loss: 1.1306401491165161
		acc: 0.5817307692307693
New best model found.
Epoch 11 complete in 48.51393246650696 seconds
	Train rv:
		loss: 0.8960745334625244
		acc: 0.6706040669856459
	Val rv:
		loss: 1.1072970628738403
		acc: 0.5775240384615384
Epochs without improvement: 1
Epoch 12 complete in 48.366610288619995 seconds
	Train rv:
		loss: 0.8353147506713867
		acc: 0.6942284688995215
	Val rv:
		loss: 1.3311101198196411
		acc: 0.5432692307692307
Epochs without improvement: 2
Epoch 13 complete in 48.54104447364807 seconds
	Train rv:
		loss: 0.8158248662948608
		acc: 0.7020035885167464
	Val rv:
		loss: 1.1098663806915283
		acc: 0.5949519230769231
New best model found.
Epoch 14 complete in 48.280112981796265 seconds
	Train rv:
		loss: 0.7446223497390747
		acc: 0.7232356459330144
	Val rv:
		loss: 1.2145602703094482
		acc: 0.5799278846153846
Epochs without improvement: 1
Epoch 15 complete in 48.024972438812256 seconds
	Train rv:
		loss: 0.6665284633636475
		acc: 0.7577751196172249
	Val rv:
		loss: 1.0941592454910278
		acc: 0.6256009615384616
New best model found.
Epoch 16 complete in 48.21929574012756 seconds
	Train rv:
		loss: 0.6420429944992065
		acc: 0.7716806220095693
	Val rv:
		loss: 1.0058950185775757
		acc: 0.6490384615384616
New best model found.
Epoch 17 complete in 48.38808226585388 seconds
	Train rv:
		loss: 0.5671653747558594
		acc: 0.7951555023923444
	Val rv:
		loss: 1.1539582014083862
		acc: 0.6256009615384616
Epochs without improvement: 1
Epoch 18 complete in 48.27386736869812 seconds
	Train rv:
		loss: 0.540667712688446
		acc: 0.8051734449760766
	Val rv:
		loss: 1.1884769201278687
		acc: 0.6298076923076923
Epochs without improvement: 2
Epoch 19 complete in 47.953550577163696 seconds
	Train rv:
		loss: 0.455011248588562
		acc: 0.8398624401913876
	Val rv:
		loss: 1.4359074831008911
		acc: 0.5979567307692307
Epochs without improvement: 3
Epoch 20 complete in 48.260632038116455 seconds
	Train rv:
		loss: 0.4100368916988373
		acc: 0.8569078947368421
	Val rv:
		loss: 1.2547528743743896
		acc: 0.6310096153846154
Epochs without improvement: 4
Epoch 21 complete in 48.14963412284851 seconds
	Train rv:
		loss: 0.3868081867694855
		acc: 0.8613935406698564
	Val rv:
		loss: 1.3832579851150513
		acc: 0.6243990384615384
Epochs without improvement: 5
Epoch 22 complete in 48.186360597610474 seconds
	Train rv:
		loss: 0.37506863474845886
		acc: 0.8669258373205742
	Val rv:
		loss: 1.419106125831604
		acc: 0.6262019230769231
Epochs without improvement: 6
Epoch 23 complete in 48.45747256278992 seconds
	Train rv:
		loss: 0.2629570960998535
		acc: 0.9102870813397129
	Val rv:
		loss: 1.7668647766113281
		acc: 0.6087740384615384
Epochs without improvement: 7
Epoch 24 complete in 48.1072633266449 seconds
	Train rv:
		loss: 0.24351292848587036
		acc: 0.9191088516746412
	Val rv:
		loss: 1.5655858516693115
		acc: 0.6237980769230769
Epochs without improvement: 8
Epoch 25 complete in 48.37424683570862 seconds
	Train rv:
		loss: 0.24898633360862732
		acc: 0.9140251196172249
	Val rv:
		loss: 1.4333021640777588
		acc: 0.6123798076923077
Epochs without improvement: 9
Epoch 26 complete in 48.712480306625366 seconds
	Train rv:
		loss: 0.23710590600967407
		acc: 0.9206040669856459
	Val rv:
		loss: 3.7948532104492188
		acc: 0.4483173076923077
Epochs without improvement: 10
Epoch 27 complete in 48.29760932922363 seconds
	Train rv:
		loss: 1.0327935218811035
		acc: 0.6203648325358851
	Val rv:
		loss: 1.4307918548583984
		acc: 0.5703125
Epochs without improvement: 11
Epoch 28 complete in 48.30120491981506 seconds
	Train rv:
		loss: 0.4598502516746521
		acc: 0.837171052631579
	Val rv:
		loss: 1.4167811870574951
		acc: 0.6111778846153846
Epochs without improvement: 12
Epoch 29 complete in 48.032390117645264 seconds
	Train rv:
		loss: 0.24215811491012573
		acc: 0.9164174641148325
	Val rv:
		loss: 1.4710618257522583
		acc: 0.6358173076923077
Epochs without improvement: 13
Epoch 30 complete in 47.992977142333984 seconds
	Train rv:
		loss: 0.1943015456199646
		acc: 0.933761961722488
	Val rv:
		loss: 1.710060954093933
		acc: 0.6514423076923077
New best model found.
Epoch 31 complete in 48.08443641662598 seconds
	Train rv:
		loss: 0.20214146375656128
		acc: 0.9262858851674641
	Val rv:
		loss: 2.4066824913024902
		acc: 0.6045673076923077
Epochs without improvement: 1
Epoch 32 complete in 48.188610315322876 seconds
	Train rv:
		loss: 0.43904221057891846
		acc: 0.8590011961722488
	Val rv:
		loss: 1.5513060092926025
		acc: 0.6334134615384616
Epochs without improvement: 2
Epoch 33 complete in 48.07791090011597 seconds
	Train rv:
		loss: 0.12350509315729141
		acc: 0.9605263157894737
	Val rv:
		loss: 2.0401220321655273
		acc: 0.6262019230769231
Epochs without improvement: 3
Epoch 34 complete in 48.382976055145264 seconds
	Train rv:
		loss: 0.13013970851898193
		acc: 0.9555921052631579
	Val rv:
		loss: 2.157362699508667
		acc: 0.6015625
Epochs without improvement: 4
Epoch 35 complete in 48.2141330242157 seconds
	Train rv:
		loss: 0.10437663644552231
		acc: 0.9648624401913876
	Val rv:
		loss: 1.7699909210205078
		acc: 0.6213942307692307
Epochs without improvement: 5
Epoch 36 complete in 48.586605072021484 seconds
	Train rv:
		loss: 0.0847153440117836
		acc: 0.9720394736842105
	Val rv:
		loss: 2.0419280529022217
		acc: 0.6129807692307693
Epochs without improvement: 6
Epoch 37 complete in 48.244412899017334 seconds
	Train rv:
		loss: 0.08861463516950607
		acc: 0.9723385167464115
	Val rv:
		loss: 1.8775875568389893
		acc: 0.6502403846153846
Epochs without improvement: 7
Epoch 38 complete in 48.383198976516724 seconds
	Train rv:
		loss: 0.0701199620962143
		acc: 0.9784688995215312
	Val rv:
		loss: 1.8523648977279663
		acc: 0.6105769230769231
Epochs without improvement: 8
Epoch 39 complete in 48.1104474067688 seconds
	Train rv:
		loss: 0.10035917907953262
		acc: 0.9660586124401914
	Val rv:
		loss: 2.1819849014282227
		acc: 0.6304086538461539
Epochs without improvement: 9
Epoch 40 complete in 48.00669741630554 seconds
	Train rv:
		loss: 0.10817098617553711
		acc: 0.9627691387559809
	Val rv:
		loss: 1.9879117012023926
		acc: 0.6382211538461539
Epochs without improvement: 10
Epoch 41 complete in 48.30780506134033 seconds
	Train rv:
		loss: 0.08183953911066055
		acc: 0.9708433014354066
	Val rv:
		loss: 2.3577864170074463
		acc: 0.6280048076923077
Epochs without improvement: 11
Epoch 42 complete in 48.415776014328 seconds
	Train rv:
		loss: 0.09273181110620499
		acc: 0.9733851674641149
	Val rv:
		loss: 1.9199726581573486
		acc: 0.6436298076923077
Epochs without improvement: 12
Epoch 43 complete in 48.057053565979004 seconds
	Train rv:
		loss: 0.07975883781909943
		acc: 0.9738337320574163
	Val rv:
		loss: 2.290274143218994
		acc: 0.6310096153846154
Epochs without improvement: 13
Epoch 44 complete in 47.92263889312744 seconds
	Train rv:
		loss: 0.1325061023235321
		acc: 0.958732057416268
	Val rv:
		loss: 1.9706075191497803
		acc: 0.6448317307692307
Epochs without improvement: 14
Epoch 45 complete in 48.33903121948242 seconds
	Train rv:
		loss: 0.04119284451007843
		acc: 0.9869916267942583
	Val rv:
		loss: 2.4314284324645996
		acc: 0.6382211538461539
Epochs without improvement: 15
Epoch 46 complete in 48.046995401382446 seconds
	Train rv:
		loss: 0.0932665541768074
		acc: 0.9696471291866029
	Val rv:
		loss: 2.5946805477142334
		acc: 0.6117788461538461
Epochs without improvement: 16
Epoch 47 complete in 48.11624765396118 seconds
	Train rv:
		loss: 0.08515732735395432
		acc: 0.9732356459330144
	Val rv:
		loss: 1.8671377897262573
		acc: 0.6496394230769231
Epochs without improvement: 17
Epoch 48 complete in 47.864280462265015 seconds
	Train rv:
		loss: 0.059514425694942474
		acc: 0.9813098086124402
	Val rv:
		loss: 2.017001152038574
		acc: 0.5877403846153846
Epochs without improvement: 18
Epoch 49 complete in 47.78394556045532 seconds
	Train rv:
		loss: 0.07795586436986923
		acc: 0.9733851674641149
	Val rv:
		loss: 2.1019465923309326
		acc: 0.6484375
Epochs without improvement: 19
Epoch 50 complete in 47.927366495132446 seconds
	Train rv:
		loss: 0.05109402909874916
		acc: 0.9844497607655502
	Val rv:
		loss: 2.5210800170898438
		acc: 0.6237980769230769
Epochs without improvement: 20
Epoch 51 complete in 48.204888105392456 seconds
	Train rv:
		loss: 0.06617707014083862
		acc: 0.9768241626794258
	Val rv:
		loss: 2.5266125202178955
		acc: 0.6075721153846154
Epochs without improvement: 21
Epoch 52 complete in 48.01484727859497 seconds
	Train rv:
		loss: 0.05950810760259628
		acc: 0.9810107655502392
	Val rv:
		loss: 1.9992238283157349
		acc: 0.6298076923076923
Epochs without improvement: 22
Epoch 53 complete in 48.191500186920166 seconds
	Train rv:
		loss: 0.06258987635374069
		acc: 0.9819078947368421
	Val rv:
		loss: 2.2737512588500977
		acc: 0.609375
Epochs without improvement: 23
Epoch 54 complete in 48.058990716934204 seconds
	Train rv:
		loss: 0.10324165970087051
		acc: 0.9660586124401914
	Val rv:
		loss: 1.9841079711914062
		acc: 0.6388221153846154
Epochs without improvement: 24
Epoch 55 complete in 48.08922529220581 seconds
	Train rv:
		loss: 0.06065021827816963
		acc: 0.9814593301435407
	Val rv:
		loss: 1.8873045444488525
		acc: 0.6280048076923077
Epochs without improvement: 25
Epoch 56 complete in 48.05720090866089 seconds
	Train rv:
		loss: 0.060048412531614304
		acc: 0.9804126794258373
	Val rv:
		loss: 2.3421366214752197
		acc: 0.6292067307692307
Epochs without improvement: 26
Epoch 57 complete in 48.26577639579773 seconds
	Train rv:
		loss: 0.09907396882772446
		acc: 0.9717404306220095
	Val rv:
		loss: 1.9667506217956543
		acc: 0.6201923076923077
Epochs without improvement: 27
Epoch 58 complete in 47.819576263427734 seconds
	Train rv:
		loss: 0.03758417069911957
		acc: 0.9886363636363636
	Val rv:
		loss: 2.3183422088623047
		acc: 0.6448317307692307
Epochs without improvement: 28
Epoch 59 complete in 48.02343511581421 seconds
	Train rv:
		loss: 0.0908774584531784
		acc: 0.9686004784688995
	Val rv:
		loss: 2.042773723602295
		acc: 0.6388221153846154
Epochs without improvement: 29
Epoch 60 complete in 48.15133500099182 seconds
	Train rv:
		loss: 0.06176285818219185
		acc: 0.978767942583732
	Val rv:
		loss: 1.9997299909591675
		acc: 0.6394230769230769
Epochs without improvement: 30
Epoch 61 complete in 47.875974893569946 seconds
	Train rv:
		loss: 0.03773790970444679
		acc: 0.9881877990430622
	Val rv:
		loss: 2.2991790771484375
		acc: 0.6394230769230769
Epochs without improvement: 31
Epoch 62 complete in 47.85290002822876 seconds
	Train rv:
		loss: 0.05059199780225754
		acc: 0.9834031100478469
	Val rv:
		loss: 2.2113516330718994
		acc: 0.640625
Epochs without improvement: 32
Epoch 63 complete in 47.78944730758667 seconds
	Train rv:
		loss: 0.06020066514611244
		acc: 0.9811602870813397
	Val rv:
		loss: 2.5582022666931152
		acc: 0.6400240384615384
Epochs without improvement: 33
Epoch 64 complete in 47.82349729537964 seconds
	Train rv:
		loss: 0.011147875338792801
		acc: 0.9970095693779905
	Val rv:
		loss: 2.8381600379943848
		acc: 0.6219951923076923
Epochs without improvement: 34
Epoch 65 complete in 48.12475919723511 seconds
	Train rv:
		loss: 0.07748069614171982
		acc: 0.9732356459330144
	Val rv:
		loss: 2.214710235595703
		acc: 0.625
Epochs without improvement: 35
Epoch 66 complete in 47.97621154785156 seconds
	Train rv:
		loss: 0.0860489085316658
		acc: 0.9715909090909091
	Val rv:
		loss: 2.2378289699554443
		acc: 0.6454326923076923
Epochs without improvement: 36
Epoch 67 complete in 47.81963086128235 seconds
	Train rv:
		loss: 0.07865917682647705
		acc: 0.9732356459330144
	Val rv:
		loss: 2.1630914211273193
		acc: 0.6358173076923077
Epochs without improvement: 37
Epoch 68 complete in 48.0413031578064 seconds
	Train rv:
		loss: 0.037997663021087646
		acc: 0.986244019138756
	Val rv:
		loss: 2.5823636054992676
		acc: 0.6177884615384616
Epochs without improvement: 38
Epoch 69 complete in 48.320868492126465 seconds
	Train rv:
		loss: 0.07760397344827652
		acc: 0.9730861244019139
	Val rv:
		loss: 2.0624425411224365
		acc: 0.6364182692307693
Epochs without improvement: 39
Epoch 70 complete in 48.00449466705322 seconds
	Train rv:
		loss: 0.03646761551499367
		acc: 0.9892344497607656
	Val rv:
		loss: 2.420416831970215
		acc: 0.6436298076923077
Epochs without improvement: 40
Epoch 71 complete in 48.53769779205322 seconds
	Train rv:
		loss: 0.012417837977409363
		acc: 0.9964114832535885
	Val rv:
		loss: 2.429703712463379
		acc: 0.6598557692307693
New best model found.
Epoch 72 complete in 48.60492992401123 seconds
	Train rv:
		loss: 0.04780029132962227
		acc: 0.9835526315789473
	Val rv:
		loss: 1.9684258699417114
		acc: 0.6304086538461539
Epochs without improvement: 1
Epoch 73 complete in 48.10045790672302 seconds
	Train rv:
		loss: 0.06693469732999802
		acc: 0.9777212918660287
	Val rv:
		loss: 2.304961919784546
		acc: 0.6550480769230769
Epochs without improvement: 2
Epoch 74 complete in 48.533198833465576 seconds
	Train rv:
		loss: 0.08592142164707184
		acc: 0.9732356459330144
	Val rv:
		loss: 2.333529233932495
		acc: 0.6298076923076923
Epochs without improvement: 3
Epoch 75 complete in 48.15162801742554 seconds
	Train rv:
		loss: 0.02048821933567524
		acc: 0.9941686602870813
	Val rv:
		loss: 2.4351422786712646
		acc: 0.6310096153846154
Epochs without improvement: 4
Epoch 76 complete in 48.09933304786682 seconds
	Train rv:
		loss: 0.08511921763420105
		acc: 0.9712918660287081
	Val rv:
		loss: 1.8868587017059326
		acc: 0.6436298076923077
Epochs without improvement: 5
Epoch 77 complete in 48.030906677246094 seconds
	Train rv:
		loss: 0.0239826999604702
		acc: 0.9922248803827751
	Val rv:
		loss: 2.26349139213562
		acc: 0.6412259615384616
Epochs without improvement: 6
Epoch 78 complete in 47.99236059188843 seconds
	Train rv:
		loss: 0.05491555109620094
		acc: 0.9820574162679426
	Val rv:
		loss: 2.2709438800811768
		acc: 0.6574519230769231
Epochs without improvement: 7
Epoch 79 complete in 48.11804747581482 seconds
	Train rv:
		loss: 0.016124874353408813
		acc: 0.9946172248803827
	Val rv:
		loss: 2.3492166996002197
		acc: 0.6490384615384616
Epochs without improvement: 8
Epoch 80 complete in 47.95153474807739 seconds
	Train rv:
		loss: 0.06214306131005287
		acc: 0.9795155502392344
	Val rv:
		loss: 2.3368418216705322
		acc: 0.6195913461538461
Epochs without improvement: 9
Epoch 81 complete in 47.9495632648468 seconds
	Train rv:
		loss: 0.060189709067344666
		acc: 0.9810107655502392
	Val rv:
		loss: 2.246680498123169
		acc: 0.6346153846153846
Epochs without improvement: 10
Epoch 82 complete in 47.91212821006775 seconds
	Train rv:
		loss: 0.05137684568762779
		acc: 0.9819078947368421
	Val rv:
		loss: 2.5911636352539062
		acc: 0.6424278846153846
Epochs without improvement: 11
Epoch 83 complete in 47.93999433517456 seconds
	Train rv:
		loss: 0.04543685168027878
		acc: 0.9878887559808612
	Val rv:
		loss: 2.2536048889160156
		acc: 0.6448317307692307
Epochs without improvement: 12
Epoch 84 complete in 47.962287187576294 seconds
	Train rv:
		loss: 0.059214018285274506
		acc: 0.9799641148325359
	Val rv:
		loss: 1.9651232957839966
		acc: 0.6358173076923077
Epochs without improvement: 13
Epoch 85 complete in 47.78535032272339 seconds
	Train rv:
		loss: 0.03488422557711601
		acc: 0.9892344497607656
	Val rv:
		loss: 2.2422842979431152
		acc: 0.6592548076923077
Epochs without improvement: 14
Epoch 86 complete in 48.09039258956909 seconds
	Train rv:
		loss: 0.0425821878015995
		acc: 0.9845992822966507
	Val rv:
		loss: 2.0484743118286133
		acc: 0.6292067307692307
Epochs without improvement: 15
Epoch 87 complete in 47.866738080978394 seconds
	Train rv:
		loss: 0.04724286124110222
		acc: 0.9844497607655502
	Val rv:
		loss: 2.3848743438720703
		acc: 0.6183894230769231
Epochs without improvement: 16
Epoch 88 complete in 47.848772287368774 seconds
	Train rv:
		loss: 0.027082402259111404
		acc: 0.9920753588516746
	Val rv:
		loss: 2.6026723384857178
		acc: 0.6424278846153846
Epochs without improvement: 17
Epoch 89 complete in 47.90491032600403 seconds
	Train rv:
		loss: 0.05193224549293518
		acc: 0.9832535885167464
	Val rv:
		loss: 2.525853395462036
		acc: 0.6033653846153846
Epochs without improvement: 18
Epoch 90 complete in 48.06782603263855 seconds
	Train rv:
		loss: 0.04580949619412422
		acc: 0.9856459330143541
	Val rv:
		loss: 2.2576003074645996
		acc: 0.6340144230769231
Epochs without improvement: 19
Epoch 91 complete in 48.038971185684204 seconds
	Train rv:
		loss: 0.04721738398075104
		acc: 0.9853468899521531
	Val rv:
		loss: 2.2565646171569824
		acc: 0.6442307692307693
Epochs without improvement: 20
Epoch 92 complete in 48.680564165115356 seconds
	Train rv:
		loss: 0.015218456275761127
		acc: 0.9964114832535885
	Val rv:
		loss: 2.4027135372161865
		acc: 0.640625
Epochs without improvement: 21
Epoch 93 complete in 48.00054931640625 seconds
	Train rv:
		loss: 0.056031834334135056
		acc: 0.9832535885167464
	Val rv:
		loss: 2.3544180393218994
		acc: 0.6225961538461539
Epochs without improvement: 22
Epoch 94 complete in 47.799474239349365 seconds
	Train rv:
		loss: 0.04892277717590332
		acc: 0.9845992822966507
	Val rv:
		loss: 2.5201961994171143
		acc: 0.6442307692307693
Epochs without improvement: 23
Epoch 95 complete in 47.96095848083496 seconds
	Train rv:
		loss: 0.001206304063089192
		acc: 1.0
	Val rv:
		loss: 2.644721031188965
		acc: 0.6466346153846154
Epochs without improvement: 24
Epoch 96 complete in 48.056077003479004 seconds
	Train rv:
		loss: 0.0003140925255138427
		acc: 1.0
	Val rv:
		loss: 2.658879280090332
		acc: 0.6544471153846154
Epochs without improvement: 25
Epoch 97 complete in 48.6577889919281 seconds
	Train rv:
		loss: 0.000193885643966496
		acc: 1.0
	Val rv:
		loss: 2.6606569290161133
		acc: 0.6550480769230769
Epochs without improvement: 26
Epoch 98 complete in 48.498016119003296 seconds
	Train rv:
		loss: 0.00020756907179020345
		acc: 1.0
	Val rv:
		loss: 2.656440496444702
		acc: 0.6568509615384616
Epochs without improvement: 27
Epoch 99 complete in 47.95058465003967 seconds
	Train rv:
		loss: 0.0002318814949830994
		acc: 1.0
	Val rv:
		loss: 2.6586461067199707
		acc: 0.6550480769230769
Epochs without improvement: 28
Epoch 100 complete in 48.26249837875366 seconds
	Train rv:
		loss: 0.00025296141393482685
		acc: 1.0
	Val rv:
		loss: 2.667809009552002
		acc: 0.6574519230769231
Epochs without improvement: 29
Done.




Training a feature extractor using erm on <class 'datasets.domainbed.PACS'> with domain sketch held out.
Training a feature extractor.
Save dir: ./results/PACS/omit_sketch/erm/trial_0
Constructor kwargs: {'dataset_constructor': <class 'datasets.domainbed.PACS'>, 'device': 'cuda:0', 'dataset_kwargs': {'domains_to_use': ['art_painting', 'cartoon', 'photo'], 'data_transform': Compose(
    Resize(size=(224, 224), interpolation=bilinear)
    ToTensor()
    Lambda()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'dataloader_kwargs': {'batch_size': 32, 'num_workers': 10}, 'model_constructor': <class 'models.resnet.PretrainedRN50'>, 'model_kwargs': {'pretrained': False}, 'optimizer_constructor': <class 'torch.optim.adam.Adam'>, 'optimizer_kwargs': {'lr': 0.0002, 'weight_decay': 0.0001}, 'loss_fn_constructor': <class 'torch.nn.modules.loss.CrossEntropyLoss'>, 'loss_fn_kwargs': {}}
Epoch 1 complete in 35.15767478942871 seconds
	Train rv:
		loss: 2.580524444580078
		acc: 0.21301626461988304
	Val rv:
		loss: 1.80284583568573
		acc: 0.30521616541353386
New best model found.
Epoch 2 complete in 35.32717275619507 seconds
	Train rv:
		loss: 1.7887450456619263
		acc: 0.30889071637426896
	Val rv:
		loss: 1.7319027185440063
		acc: 0.3036889097744361
Epochs without improvement: 1
Epoch 3 complete in 35.441407918930054 seconds
	Train rv:
		loss: 1.7271385192871094
		acc: 0.3459658260233918
	Val rv:
		loss: 1.6495486497879028
		acc: 0.38862781954887216
New best model found.
Epoch 4 complete in 35.22145390510559 seconds
	Train rv:
		loss: 1.6252045631408691
		acc: 0.3880436769005848
	Val rv:
		loss: 1.5227922201156616
		acc: 0.41741071428571425
New best model found.
Epoch 5 complete in 35.129486083984375 seconds
	Train rv:
		loss: 1.529318928718567
		acc: 0.4220120614035087
	Val rv:
		loss: 1.4858031272888184
		acc: 0.4400845864661654
New best model found.
Epoch 6 complete in 35.27597618103027 seconds
	Train rv:
		loss: 1.466806411743164
		acc: 0.44803088450292394
	Val rv:
		loss: 1.4227120876312256
		acc: 0.4602913533834586
New best model found.
Epoch 7 complete in 35.13452982902527 seconds
	Train rv:
		loss: 1.4046519994735718
		acc: 0.4725420321637427
	Val rv:
		loss: 1.4188592433929443
		acc: 0.4494830827067669
Epochs without improvement: 1
Epoch 8 complete in 35.22230291366577 seconds
	Train rv:
		loss: 1.3491501808166504
		acc: 0.49312408625730997
	Val rv:
		loss: 1.3526556491851807
		acc: 0.49577067669172936
New best model found.
Epoch 9 complete in 35.20595836639404 seconds
	Train rv:
		loss: 1.303285837173462
		acc: 0.507172880116959
	Val rv:
		loss: 1.3299003839492798
		acc: 0.50046992481203
New best model found.
Epoch 10 complete in 35.26412081718445 seconds
	Train rv:
		loss: 1.2713115215301514
		acc: 0.5266812865497076
	Val rv:
		loss: 1.3675645589828491
		acc: 0.5015272556390977
New best model found.
Epoch 11 complete in 35.36672568321228 seconds
	Train rv:
		loss: 1.2534208297729492
		acc: 0.5420550073099415
	Val rv:
		loss: 1.2678859233856201
		acc: 0.5284304511278195
New best model found.
Epoch 12 complete in 35.29452323913574 seconds
	Train rv:
		loss: 1.1852893829345703
		acc: 0.5617918494152047
	Val rv:
		loss: 1.2256125211715698
		acc: 0.540296052631579
New best model found.
Epoch 13 complete in 35.426005125045776 seconds
	Train rv:
		loss: 1.1422547101974487
		acc: 0.5762975146198831
	Val rv:
		loss: 1.238207221031189
		acc: 0.5435855263157895
New best model found.
Epoch 14 complete in 35.18147945404053 seconds
	Train rv:
		loss: 1.0985517501831055
		acc: 0.5998720760233919
	Val rv:
		loss: 1.1769083738327026
		acc: 0.5782424812030075
New best model found.
Epoch 15 complete in 35.37497282028198 seconds
	Train rv:
		loss: 1.02978515625
		acc: 0.6249086257309941
	Val rv:
		loss: 1.1736829280853271
		acc: 0.5582706766917294
Epochs without improvement: 1
Epoch 16 complete in 35.306729555130005 seconds
	Train rv:
		loss: 0.9650523662567139
		acc: 0.6403965643274854
	Val rv:
		loss: 1.2000584602355957
		acc: 0.5691964285714285
Epochs without improvement: 2
Epoch 17 complete in 35.305229902267456 seconds
	Train rv:
		loss: 0.951596736907959
		acc: 0.6556560672514621
	Val rv:
		loss: 1.372096300125122
		acc: 0.5331296992481204
Epochs without improvement: 3
Epoch 18 complete in 35.49279975891113 seconds
	Train rv:
		loss: 0.8879866600036621
		acc: 0.6769234283625731
	Val rv:
		loss: 1.2528554201126099
		acc: 0.5681390977443609
Epochs without improvement: 4
Epoch 19 complete in 35.45381689071655 seconds
	Train rv:
		loss: 0.8171425461769104
		acc: 0.6903097587719298
	Val rv:
		loss: 1.2697135210037231
		acc: 0.5667293233082706
Epochs without improvement: 5
Epoch 20 complete in 35.56676959991455 seconds
	Train rv:
		loss: 0.7555804252624512
		acc: 0.7192297149122807
	Val rv:
		loss: 1.1845390796661377
		acc: 0.6040883458646616
New best model found.
Epoch 21 complete in 35.64464497566223 seconds
	Train rv:
		loss: 0.6938843131065369
		acc: 0.7444718567251463
	Val rv:
		loss: 1.2509615421295166
		acc: 0.5864661654135338
Epochs without improvement: 1
Epoch 22 complete in 35.58511137962341 seconds
	Train rv:
		loss: 0.6073348522186279
		acc: 0.7776178728070176
	Val rv:
		loss: 1.2375849485397339
		acc: 0.5898731203007519
Epochs without improvement: 2
Epoch 23 complete in 35.46061134338379 seconds
	Train rv:
		loss: 0.5357349514961243
		acc: 0.7998903508771931
	Val rv:
		loss: 1.4872548580169678
		acc: 0.578125
Epochs without improvement: 3
Epoch 24 complete in 35.613722801208496 seconds
	Train rv:
		loss: 0.4788025915622711
		acc: 0.8224597953216374
	Val rv:
		loss: 1.4669649600982666
		acc: 0.6275845864661654
New best model found.
Epoch 25 complete in 35.502161502838135 seconds
	Train rv:
		loss: 0.47721362113952637
		acc: 0.8335617690058479
	Val rv:
		loss: 1.542979121208191
		acc: 0.584703947368421
Epochs without improvement: 1
Epoch 26 complete in 35.485005617141724 seconds
	Train rv:
		loss: 0.34987983107566833
		acc: 0.8758223684210527
	Val rv:
		loss: 1.6762522459030151
		acc: 0.5834116541353384
Epochs without improvement: 2
Epoch 27 complete in 35.481109857559204 seconds
	Train rv:
		loss: 0.3495866656303406
		acc: 0.8728755482456141
	Val rv:
		loss: 1.9194068908691406
		acc: 0.5716635338345865
Epochs without improvement: 3
Epoch 28 complete in 35.31753468513489 seconds
	Train rv:
		loss: 0.31080952286720276
		acc: 0.8893229166666667
	Val rv:
		loss: 1.696012020111084
		acc: 0.6087875939849624
Epochs without improvement: 4
Epoch 29 complete in 35.57552528381348 seconds
	Train rv:
		loss: 0.2783783972263336
		acc: 0.9027549342105263
	Val rv:
		loss: 2.058990478515625
		acc: 0.5549812030075189
Epochs without improvement: 5
Epoch 30 complete in 35.788657665252686 seconds
	Train rv:
		loss: 0.22347287833690643
		acc: 0.9233598318713451
	Val rv:
		loss: 2.1733081340789795
		acc: 0.5845864661654135
Epochs without improvement: 6
Epoch 31 complete in 35.49352216720581 seconds
	Train rv:
		loss: 0.2496265172958374
		acc: 0.9097907529239767
	Val rv:
		loss: 1.9119309186935425
		acc: 0.600328947368421
Epochs without improvement: 7
Epoch 32 complete in 35.52138805389404 seconds
	Train rv:
		loss: 0.2122889757156372
		acc: 0.9319947002923977
	Val rv:
		loss: 2.0842413902282715
		acc: 0.5767152255639099
Epochs without improvement: 8
Epoch 33 complete in 35.39878821372986 seconds
	Train rv:
		loss: 0.13774771988391876
		acc: 0.9538331505847953
	Val rv:
		loss: 2.0502078533172607
		acc: 0.5499295112781954
Epochs without improvement: 9
Epoch 34 complete in 35.68411564826965 seconds
	Train rv:
		loss: 0.16783173382282257
		acc: 0.944078947368421
	Val rv:
		loss: 2.4414753913879395
		acc: 0.5695488721804511
Epochs without improvement: 10
Epoch 35 complete in 35.40980648994446 seconds
	Train rv:
		loss: 0.09519542753696442
		acc: 0.9693667763157895
	Val rv:
		loss: 2.4523842334747314
		acc: 0.5763627819548872
Epochs without improvement: 11
Epoch 36 complete in 35.425402879714966 seconds
	Train rv:
		loss: 0.10942398756742477
		acc: 0.9614400584795322
	Val rv:
		loss: 2.3290135860443115
		acc: 0.5393562030075189
Epochs without improvement: 12
Epoch 37 complete in 35.4363899230957 seconds
	Train rv:
		loss: 0.130723774433136
		acc: 0.9574424342105263
	Val rv:
		loss: 2.61495041847229
		acc: 0.5582706766917294
Epochs without improvement: 13
Epoch 38 complete in 35.53925371170044 seconds
	Train rv:
		loss: 0.13561323285102844
		acc: 0.95218841374269
	Val rv:
		loss: 2.3806354999542236
		acc: 0.5925751879699248
Epochs without improvement: 14
Epoch 39 complete in 35.51284074783325 seconds
	Train rv:
		loss: 0.13863080739974976
		acc: 0.9537874634502925
	Val rv:
		loss: 2.2579007148742676
		acc: 0.59375
Epochs without improvement: 15
Epoch 40 complete in 35.34997844696045 seconds
	Train rv:
		loss: 0.08322448283433914
		acc: 0.9749634502923977
	Val rv:
		loss: 2.809972047805786
		acc: 0.5750704887218046
Epochs without improvement: 16
Epoch 41 complete in 35.63170862197876 seconds
	Train rv:
		loss: 0.1379423588514328
		acc: 0.9529194078947368
	Val rv:
		loss: 2.393313407897949
		acc: 0.5554511278195489
Epochs without improvement: 17
Epoch 42 complete in 35.45669603347778 seconds
	Train rv:
		loss: 0.09683273732662201
		acc: 0.9708059210526315
	Val rv:
		loss: 2.407409906387329
		acc: 0.6005639097744361
Epochs without improvement: 18
Epoch 43 complete in 35.731728076934814 seconds
	Train rv:
		loss: 0.11603736877441406
		acc: 0.9654605263157895
	Val rv:
		loss: 2.473787546157837
		acc: 0.6082001879699248
Epochs without improvement: 19
Epoch 44 complete in 35.38110303878784 seconds
	Train rv:
		loss: 0.0816349983215332
		acc: 0.9741867690058479
	Val rv:
		loss: 2.9093902111053467
		acc: 0.5446428571428572
Epochs without improvement: 20
Epoch 45 complete in 35.325801849365234 seconds
	Train rv:
		loss: 0.12937332689762115
		acc: 0.9560032894736842
	Val rv:
		loss: 2.500140428543091
		acc: 0.5676691729323309
Epochs without improvement: 21
Epoch 46 complete in 35.58490967750549 seconds
	Train rv:
		loss: 0.06651121377944946
		acc: 0.9763569078947368
	Val rv:
		loss: 2.0882718563079834
		acc: 0.5832941729323309
Epochs without improvement: 22
Epoch 47 complete in 35.22361946105957 seconds
	Train rv:
		loss: 0.06626322120428085
		acc: 0.9773848684210527
	Val rv:
		loss: 2.710991621017456
		acc: 0.5734257518796992
Epochs without improvement: 23
Epoch 48 complete in 35.20929145812988 seconds
	Train rv:
		loss: 0.08620832115411758
		acc: 0.9745522660818714
	Val rv:
		loss: 2.456361770629883
		acc: 0.5894031954887218
Epochs without improvement: 24
Epoch 49 complete in 35.296709060668945 seconds
	Train rv:
		loss: 0.03889625146985054
		acc: 0.9866365131578947
	Val rv:
		loss: 2.9786112308502197
		acc: 0.6024436090225563
Epochs without improvement: 25
Epoch 50 complete in 35.33711624145508 seconds
	Train rv:
		loss: 0.08929076790809631
		acc: 0.9681332236842105
	Val rv:
		loss: 2.4509787559509277
		acc: 0.583999060150376
Epochs without improvement: 26
Epoch 51 complete in 35.359370470047 seconds
	Train rv:
		loss: 0.12763500213623047
		acc: 0.9599095394736842
	Val rv:
		loss: 2.072566032409668
		acc: 0.5915178571428572
Epochs without improvement: 27
Epoch 52 complete in 35.30242323875427 seconds
	Train rv:
		loss: 0.07513004541397095
		acc: 0.9773848684210527
	Val rv:
		loss: 2.622468948364258
		acc: 0.584703947368421
Epochs without improvement: 28
Epoch 53 complete in 35.7815682888031 seconds
	Train rv:
		loss: 0.06118999049067497
		acc: 0.9803088450292399
	Val rv:
		loss: 2.5553417205810547
		acc: 0.5921052631578947
Epochs without improvement: 29
Epoch 54 complete in 35.910584926605225 seconds
	Train rv:
		loss: 0.0589505136013031
		acc: 0.9823190789473685
	Val rv:
		loss: 2.735180377960205
		acc: 0.5850563909774437
Epochs without improvement: 30
Epoch 55 complete in 35.7383496761322 seconds
	Train rv:
		loss: 0.05994321033358574
		acc: 0.9782529239766082
	Val rv:
		loss: 2.607797861099243
		acc: 0.5639097744360901
Epochs without improvement: 31
Epoch 56 complete in 35.620901107788086 seconds
	Train rv:
		loss: 0.08407614380121231
		acc: 0.9736842105263158
	Val rv:
		loss: 2.703119993209839
		acc: 0.5849389097744361
Epochs without improvement: 32
Epoch 57 complete in 35.50927233695984 seconds
	Train rv:
		loss: 0.04485670104622841
		acc: 0.9845805921052632
	Val rv:
		loss: 2.492276906967163
		acc: 0.5807095864661654
Epochs without improvement: 33
Epoch 58 complete in 35.47660684585571 seconds
	Train rv:
		loss: 0.043766189366579056
		acc: 0.987047697368421
	Val rv:
		loss: 2.7303287982940674
		acc: 0.5730733082706767
Epochs without improvement: 34
Epoch 59 complete in 35.32592558860779 seconds
	Train rv:
		loss: 0.117925263941288
		acc: 0.9605263157894737
	Val rv:
		loss: 2.675210475921631
		acc: 0.5930451127819548
Epochs without improvement: 35
Epoch 60 complete in 35.80803036689758 seconds
	Train rv:
		loss: 0.08036715537309647
		acc: 0.9728618421052632
	Val rv:
		loss: 2.1444661617279053
		acc: 0.5741306390977443
Epochs without improvement: 36
Epoch 61 complete in 35.782957553863525 seconds
	Train rv:
		loss: 0.0904279351234436
		acc: 0.9690012792397662
	Val rv:
		loss: 2.414043426513672
		acc: 0.57765507518797
Epochs without improvement: 37
Epoch 62 complete in 35.45992374420166 seconds
	Train rv:
		loss: 0.0652235597372055
		acc: 0.9788240131578947
	Val rv:
		loss: 2.9779388904571533
		acc: 0.5730733082706767
Epochs without improvement: 38
Epoch 63 complete in 35.68542671203613 seconds
	Train rv:
		loss: 0.07208088040351868
		acc: 0.9775904605263158
	Val rv:
		loss: 3.0318925380706787
		acc: 0.5787124060150376
Epochs without improvement: 39
Epoch 64 complete in 35.41728496551514 seconds
	Train rv:
		loss: 0.04646692052483559
		acc: 0.9851973684210527
	Val rv:
		loss: 2.8415207862854004
		acc: 0.5800046992481204
Epochs without improvement: 40
Epoch 65 complete in 35.451157569885254 seconds
	Train rv:
		loss: 0.07093995064496994
		acc: 0.9769736842105263
	Val rv:
		loss: 2.5997633934020996
		acc: 0.569078947368421
Epochs without improvement: 41
Epoch 66 complete in 35.414979457855225 seconds
	Train rv:
		loss: 0.05372238904237747
		acc: 0.9833927266081872
	Val rv:
		loss: 2.7220919132232666
		acc: 0.5898731203007519
Epochs without improvement: 42
Epoch 67 complete in 35.447256565093994 seconds
	Train rv:
		loss: 0.05351826921105385
		acc: 0.9845805921052632
	Val rv:
		loss: 2.8671047687530518
		acc: 0.6037359022556391
Epochs without improvement: 43
Epoch 68 complete in 35.39760613441467 seconds
	Train rv:
		loss: 0.015103776007890701
		acc: 0.9973729897660819
	Val rv:
		loss: 3.270197868347168
		acc: 0.5701362781954887
Epochs without improvement: 44
Epoch 69 complete in 35.66230058670044 seconds
	Train rv:
		loss: 0.04341693967580795
		acc: 0.9866365131578947
	Val rv:
		loss: 2.810657262802124
		acc: 0.580827067669173
Epochs without improvement: 45
Epoch 70 complete in 35.54455590248108 seconds
	Train rv:
		loss: 0.04074880853295326
		acc: 0.9884868421052632
	Val rv:
		loss: 2.6665666103363037
		acc: 0.5721334586466165
Epochs without improvement: 46
Epoch 71 complete in 35.39716958999634 seconds
	Train rv:
		loss: 0.06791035830974579
		acc: 0.977796052631579
	Val rv:
		loss: 2.449312210083008
		acc: 0.5837640977443609
Epochs without improvement: 47
Epoch 72 complete in 35.260746717453 seconds
	Train rv:
		loss: 0.0886184424161911
		acc: 0.9724506578947368
	Val rv:
		loss: 2.5129599571228027
		acc: 0.60890507518797
Epochs without improvement: 48
Epoch 73 complete in 35.69117188453674 seconds
	Train rv:
		loss: 0.08599191904067993
		acc: 0.9716282894736842
	Val rv:
		loss: 2.211136817932129
		acc: 0.5452302631578947
Epochs without improvement: 49
Epoch 74 complete in 35.64707064628601 seconds
	Train rv:
		loss: 0.03678131848573685
		acc: 0.9899259868421053
	Val rv:
		loss: 2.6240546703338623
		acc: 0.5676691729323309
Epochs without improvement: 50
Epoch 75 complete in 35.509015798568726 seconds
	Train rv:
		loss: 0.06171214580535889
		acc: 0.9815423976608187
	Val rv:
		loss: 2.5941414833068848
		acc: 0.584703947368421
Epochs without improvement: 51
Epoch 76 complete in 35.23683452606201 seconds
	Train rv:
		loss: 0.07530722767114639
		acc: 0.9733187134502925
	Val rv:
		loss: 2.541137218475342
		acc: 0.5823543233082706
Epochs without improvement: 52
Epoch 77 complete in 35.331485748291016 seconds
	Train rv:
		loss: 0.06313154101371765
		acc: 0.9801032529239767
	Val rv:
		loss: 2.7908191680908203
		acc: 0.581531954887218
Epochs without improvement: 53
Epoch 78 complete in 35.46944332122803 seconds
	Train rv:
		loss: 0.026519307866692543
		acc: 0.993421052631579
	Val rv:
		loss: 2.7615253925323486
		acc: 0.5931625939849624
Epochs without improvement: 54
Epoch 79 complete in 35.6321918964386 seconds
	Train rv:
		loss: 0.023152397945523262
		acc: 0.9930098684210527
	Val rv:
		loss: 2.8019092082977295
		acc: 0.5824718045112782
Epochs without improvement: 55
Epoch 80 complete in 35.45462512969971 seconds
	Train rv:
		loss: 0.06608834117650986
		acc: 0.9776361476608187
	Val rv:
		loss: 2.4222326278686523
		acc: 0.5613251879699248
Epochs without improvement: 56
Epoch 81 complete in 35.43949246406555 seconds
	Train rv:
		loss: 0.06894788891077042
		acc: 0.9790752923976609
	Val rv:
		loss: 2.2484562397003174
		acc: 0.6063204887218046
Epochs without improvement: 57
Epoch 82 complete in 35.47879338264465 seconds
	Train rv:
		loss: 0.03735632076859474
		acc: 0.9899259868421053
	Val rv:
		loss: 2.9206676483154297
		acc: 0.5809445488721805
Epochs without improvement: 58
Epoch 83 complete in 35.37202572822571 seconds
	Train rv:
		loss: 0.035753749310970306
		acc: 0.98828125
	Val rv:
		loss: 2.3410444259643555
		acc: 0.5811795112781954
Epochs without improvement: 59
Epoch 84 complete in 35.41073775291443 seconds
	Train rv:
		loss: 0.030035747215151787
		acc: 0.9917763157894737
	Val rv:
		loss: 2.953965425491333
		acc: 0.5775375939849624
Epochs without improvement: 60
Epoch 85 complete in 35.353516578674316 seconds
	Train rv:
		loss: 0.09033648669719696
		acc: 0.9677677266081872
	Val rv:
		loss: 2.8005547523498535
		acc: 0.5704887218045113
Epochs without improvement: 61
Epoch 86 complete in 35.47193479537964 seconds
	Train rv:
		loss: 0.028511598706245422
		acc: 0.9925986842105263
	Val rv:
		loss: 3.0450332164764404
		acc: 0.6013862781954887
Epochs without improvement: 62
Epoch 87 complete in 35.33291482925415 seconds
	Train rv:
		loss: 0.018118249252438545
		acc: 0.9946546052631579
	Val rv:
		loss: 2.892573595046997
		acc: 0.5657894736842105
Epochs without improvement: 63
Epoch 88 complete in 35.34530806541443 seconds
	Train rv:
		loss: 0.06602943688631058
		acc: 0.9796463815789473
	Val rv:
		loss: 2.976668357849121
		acc: 0.57765507518797
Epochs without improvement: 64
Epoch 89 complete in 35.49782967567444 seconds
	Train rv:
		loss: 0.05852046608924866
		acc: 0.98046875
	Val rv:
		loss: 2.915271520614624
		acc: 0.5906954887218046
Epochs without improvement: 65
Epoch 90 complete in 35.291017293930054 seconds
	Train rv:
		loss: 0.04597249999642372
		acc: 0.9847861842105263
	Val rv:
		loss: 2.790742874145508
		acc: 0.5738956766917294
Epochs without improvement: 66
Epoch 91 complete in 35.307777643203735 seconds
	Train rv:
		loss: 0.030259715393185616
		acc: 0.9903828581871346
	Val rv:
		loss: 3.0963380336761475
		acc: 0.5707236842105263
Epochs without improvement: 67
Epoch 92 complete in 35.57068347930908 seconds
	Train rv:
		loss: 0.077645443379879
		acc: 0.9736842105263158
	Val rv:
		loss: 2.767953872680664
		acc: 0.5865836466165414
Epochs without improvement: 68
Epoch 93 complete in 35.20937442779541 seconds
	Train rv:
		loss: 0.00635465607047081
		acc: 0.9979440789473685
	Val rv:
		loss: 3.141963243484497
		acc: 0.5857612781954887
Epochs without improvement: 69
Epoch 94 complete in 35.45571851730347 seconds
	Train rv:
		loss: 0.011718454770743847
		acc: 0.9954769736842105
	Val rv:
		loss: 2.9787588119506836
		acc: 0.5487546992481204
Epochs without improvement: 70
Epoch 95 complete in 35.66983675956726 seconds
	Train rv:
		loss: 0.09090078622102737
		acc: 0.9708059210526315
	Val rv:
		loss: 2.8592846393585205
		acc: 0.5641447368421053
Epochs without improvement: 71
Epoch 96 complete in 35.41974997520447 seconds
	Train rv:
		loss: 0.05191744118928909
		acc: 0.9833470394736842
	Val rv:
		loss: 2.823704481124878
		acc: 0.5760103383458647
Epochs without improvement: 72
Epoch 97 complete in 35.37889552116394 seconds
	Train rv:
		loss: 0.03076735883951187
		acc: 0.9915707236842105
	Val rv:
		loss: 2.717581033706665
		acc: 0.5798872180451128
Epochs without improvement: 73
Epoch 98 complete in 35.30771613121033 seconds
	Train rv:
		loss: 0.04817117378115654
		acc: 0.9838495979532164
	Val rv:
		loss: 2.669570207595825
		acc: 0.5682565789473685
Epochs without improvement: 74
Epoch 99 complete in 35.46608901023865 seconds
	Train rv:
		loss: 0.051785390824079514
		acc: 0.9825246710526315
	Val rv:
		loss: 2.7343690395355225
		acc: 0.578125
Epochs without improvement: 75
Epoch 100 complete in 35.339651107788086 seconds
	Train rv:
		loss: 0.030575549229979515
		acc: 0.9888980263157895
	Val rv:
		loss: 3.108144760131836
		acc: 0.583999060150376
Epochs without improvement: 76
Done.




